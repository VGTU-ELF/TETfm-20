### Darbo Tikslas

* [ ] Patikrinti tinklo nustatymus.  +
* [ ] Susipažinti su `iptable` sintakse. +
* [ ] Nustatyti paprastą tarpsegmentinį ekraną.

### Trumpas atlikto darbo aprašymas

#### 1. Virtualaus kompiuterio konfigūracija

Tikrinu IP adresus:

```
enp0s3: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 10.0.2.15  netmask 255.255.255.0  broadcast 10.0.2.255
        inet6 fe80::440e:4f39:f7ec:bb91  prefixlen 64  scopeid 0x20<link>
        ether 08:00:27:7e:da:b1  txqueuelen 1000  (Ethernet)
        RX packets 32094  bytes 40220614 (40.2 MB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 15495  bytes 1016242 (1.0 MB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

enp0s8: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 192.168.10.14  netmask 255.255.255.0  broadcast 192.168.10.255
        inet6 fe80::a00:27ff:fe40:2cf6  prefixlen 64  scopeid 0x20<link>
        ether 08:00:27:40:2c:f6  txqueuelen 1000  (Ethernet)
        RX packets 51491  bytes 3770623 (3.7 MB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 78571  bytes 33188421 (33.1 MB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10<host>
        loop  txqueuelen 1000  (Local Loopback)
        RX packets 816  bytes 70179 (70.1 KB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 816  bytes 70179 (70.1 KB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

```

Tikrinu maršrutizacijos lentelę:

```
osboxes@ldvm1:~$ route
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
default         192.168.10.254  0.0.0.0         UG    0      0        0 enp0s8
default         10.0.2.2        0.0.0.0         UG    100    0        0 enp0s3
10.0.2.0        0.0.0.0         255.255.255.0   U     100    0        0 enp0s3
link-local      0.0.0.0         255.255.0.0     U     1000   0        0 enp0s8
192.168.10.0    0.0.0.0         255.255.255.0   U     0      0        0 enp0s8
```

* Nustatymai nevsai atitinka LD aprašą:

** 1. Vietoj `eth*` tinklo sąsajų vardų Linux naudoja `enp0s*` vardus.  +
   (šiame darbe naudojamas branduolys `5.8.0-59-generic`)  +
   Palieku kaip yra.

** 2. Trūksta `10.10.10.x` adreso (nes LD2 buvo uždėtas rankomis, o po to OS perkrauta).

** 3. OS turi du vartus pagal nutylėjimą:

*** vienas pasiekiamas per `enp0s3`, _NAT_ tipo tinklo sąsają (su automatiniu IP adresu);
*** kitas pasiekiamas per `enp0s8`, _Host-only_ tipo tinklo sąsają.
+
   Atsekiau, kad pirmuosius vartus sukonfigūruoja _NetworkManager_ įrankis,
   sukurdamas dedikuotą tinklo prisijungimą
   (tam atskirą tinklo valdymo abstrakciją):
+
```
osboxes@ldvm1:~$ nmcli connection show
NAME                UUID                                  TYPE      DEVICE
Wired connection 1  2c671148-b52a-4426-9325-d35a52967e3c  ethernet  enp0s3

osboxes@ldvm1:~$ nmcli connection show id "Wired connection 1" | grep 10.0.2.2
IP4.GATEWAY:                            10.0.2.2
IP4.ROUTE[1]:                           dst = 0.0.0.0/0, nh = 10.0.2.2, mt = 100
DHCP4.OPTION[23]:                       routers = 10.0.2.2
```

Pataisau `interfaces` failą ir palyginu su ankstesne versija:

```
osboxes@ldvm1:~$ sudo cp -av /etc/network/interfaces /etc/network/interfaces.BACKUP
'/etc/network/interfaces' -> '/etc/network/interfaces.BACKUP'

osboxes@ldvm1:~$ sudo vim.tiny /etc/network/interfaces

osboxes@ldvm1:~$ diff -u /etc/network/interfaces.BACKUP /etc/network/interfaces
--- /etc/network/interfaces.BACKUP  2021-07-02 15:19:26.453975316 -0400
+++ /etc/network/interfaces 2021-07-02 15:19:30.491993480 -0400
@@ -1,6 +1,11 @@
 auto enp0s8
+auto enp0s8:2
 
 iface enp0s8 inet static
 address 192.168.10.14
 netmask 255.255.255.0
 gateway 192.168.10.254
+
+iface enp0s8:2 inet static
+address 10.10.10.4
```

Aktyvuoju pakeistus nustatymus:

```
osboxes@ldvm1:~$ sudo ifup enp0s8:2

osboxes@ldvm1:~$ ifconfig -a
enp0s3: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        ether 08:00:27:7e:da:b1  txqueuelen 1000  (Ethernet)
        RX packets 32114  bytes 40222382 (40.2 MB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 15527  bytes 1018963 (1.0 MB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

enp0s8: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 192.168.10.14  netmask 255.255.255.0  broadcast 192.168.10.255
        inet6 fe80::a00:27ff:fe40:2cf6  prefixlen 64  scopeid 0x20<link>
        ether 08:00:27:40:2c:f6  txqueuelen 1000  (Ethernet)
        RX packets 53197  bytes 3911386 (3.9 MB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 79746  bytes 33383444 (33.3 MB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

enp0s8:2: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 10.10.10.4  netmask 255.255.255.0  broadcast 10.10.10.255
        ether 08:00:27:40:2c:f6  txqueuelen 1000  (Ethernet)

lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10<host>
        loop  txqueuelen 1000  (Local Loopback)
        RX packets 817  bytes 70252 (70.2 KB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 817  bytes 70252 (70.2 KB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

```
Abu IP adresai, prašomi LD3, nurodyti.

* Nereikalingus vartus pagal nutylėjimą bandau išmest būtent per _NetworkManager_
  kartu su minimu abstrakčiu tinklo prisijungimu:
+
```
osboxes@ldvm1:~$ sudo nmcli connection delete "Wired connection 1"
Connection 'Wired connection 1' (2c671148-b52a-4426-9325-d35a52967e3c) successfully deleted.
```

** Tikrinu maršrutizacijos lentelę:
+
```
osboxes@ldvm1:~$ route
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
default         192.168.10.254  0.0.0.0         UG    0      0        0 enp0s8
10.10.10.0      0.0.0.0         255.255.255.0   U     0      0        0 enp0s8
link-local      0.0.0.0         255.255.0.0     U     1000   0        0 enp0s8
192.168.10.0    0.0.0.0         255.255.255.0   U     0      0        0 enp0s8
```
Vieninteliai vartai pagal nutylėjimą yra `192.168.10.254`, kaip ir prašo LD3 aprašas.  +
Patikrinimo žingsnis atliktas.

#### 2. Tinklo paslaugų tikrinimas

Diegiu grafinę priemonę `sysvconfig`:

```
osboxes@ldvm1:~$ sudo apt-get install sysvconfig
Reading package lists... Done
Building dependency tree       
Reading state information... Done
E: Unable to locate package sysvconfig
```


* Programinės įrangos valdymo įrankis neranda minimos priemonės.

** Mėginu atnaujinti programų sąrašus:
+
```
osboxes@ldvm1:~$ sudo apt-get update
0% [Working]
Err:1 http://security.ubuntu.com/ubuntu focal-security InRelease            
  Temporary failure resolving 'security.ubuntu.com'
Err:2 http://us.archive.ubuntu.com/ubuntu focal InRelease                   
  Temporary failure resolving 'us.archive.ubuntu.com'
Err:3 http://us.archive.ubuntu.com/ubuntu focal-updates InRelease
  Temporary failure resolving 'us.archive.ubuntu.com'
Err:4 http://us.archive.ubuntu.com/ubuntu focal-backports InRelease
  Temporary failure resolving 'us.archive.ubuntu.com'
Reading package lists... Done           
W: Failed to fetch http://us.archive.ubuntu.com/ubuntu/dists/focal/InRelease  Temporary failure resolving 'us.archive.ubuntu.com'
W: Failed to fetch http://us.archive.ubuntu.com/ubuntu/dists/focal-updates/InRelease  Temporary failure resolving 'us.archive.ubuntu.com'
W: Failed to fetch http://us.archive.ubuntu.com/ubuntu/dists/focal-backports/InRelease  Temporary failure resolving 'us.archive.ubuntu.com'
W: Failed to fetch http://security.ubuntu.com/ubuntu/dists/focal-security/InRelease  Temporary failure resolving 'security.ubuntu.com'
W: Some index files failed to download. They have been ignored, or old ones used instead.
```

** Paaiškėja, kad pašalinus vartus pagal nutylėjimą `10.0.2.2`, nustojo veikti interneto ryšys.  +
   Jis veikdavo per tinklo sąsają `enp0s3`, kuri VirtualBox sistemoje yra _NAT_ tipo (skirta išėjimui į internetą).  +

** Kadangi dabar ėmė veikti tik vartai per `192.168.10.254` (priklausantys Host OS),
   teko konfigūruoti maršrutizavimą + įjungti _NAT_ mechanizmą jau Host OS pusėje būtent šiai Guest tinklo sąsajai (o ne įprastinei).  +
   (Neaprašau Host OS veiksmų, tai nebūtinai Linux sistema)

** Sąrašų atnaujinimas vėl veikia:
+
```
osboxes@ldvm1:~$ sudo apt-get update
Hit:1 http://us.archive.ubuntu.com/ubuntu focal InRelease
Get:2 http://security.ubuntu.com/ubuntu focal-security InRelease [114 kB]
Get:3 http://us.archive.ubuntu.com/ubuntu focal-updates InRelease [114 kB]
  ...
Get:21 http://us.archive.ubuntu.com/ubuntu focal-backports/universe Translation-en [2,060 B]
Get:22 http://us.archive.ubuntu.com/ubuntu focal-backports/universe amd64 DEP-11 Metadata [1,780 B]
Get:23 http://us.archive.ubuntu.com/ubuntu focal-backports/universe amd64 c-n-f Metadata [288 B]
Fetched 4,078 kB in 10s (391 kB/s)
Reading package lists... Done
```

** Turbūt vertėtų įtraukti tokį patikslinimą į laboratorinio darbo aprašą.  +
   (apie reikiamą _VirtualBox_ tinklo sąsajos tipą + maršrutizavimą tarp Host ir Guest OS)

** Tęsiu `sysvconfig` diegimą.
   Tokio paketo _Ubuntu 20.04.2_ neturi:
+
```
osboxes@ldvm1:~$ sudo apt-get install sysvconfig
Reading package lists... Done
Building dependency tree       
Reading state information... Done
E: Unable to locate package sysvconfig

osboxes@ldvm1:~$ apt search sysvconfig
Sorting... Done
Full Text Search... Done
```

** Panašu, kad šis įrankis iš Ubuntu pašalintas 2009-09-11:  +
   https://superuser.com/questions/96040/did-sysvconfig-disappear-in-ubuntu-9-10

** Taip pat dabar neveikia ir `sysvconfig` atitikmenys, dar veikę po jo pašalinimo:   +
   `sysv-rc-conf`, `rcconf`:  +
   https://askubuntu.com/questions/1043248/rcconf-package-alternative-in-bionic-beaver

** Panašu, kad jie nebeveikia nuo 2015 m., kai OS atsirado `systemd` mechanizmas.  +
   Ir tai kėlė nepatogumų žmonėms, atnaujinantiems Ubuntu jau net nuo versijos `14.04`:  +
   https://askubuntu.com/questions/1106216/ubuntu-18-04-cant-install-sysv-rc-conf-package-for-managing-startup-services#comment1824791_1106217

** Galbūt reikėtų pagal tai irgi patikslinti LD3 aprašą?


* Ieškau atitikmenų darbui su SystemD mechanizmu.  +
   +
  Susirandu įrankį `serman2`: https://aur.archlinux.org/packages/serman

** Pasiimu jį iš GitHub:
+
```
osboxes@ldvm1:~$ mkdir src

osboxes@ldvm1:~$ cd src/

osboxes@ldvm1:~$ git clone https://github.com/baoboa/serman
Cloning into 'serman'...
remote: Enumerating objects: 41, done.
remote: Total 41 (delta 0), reused 0 (delta 0), pack-reused 41
Unpacking objects: 100% (41/41), 32.70 KiB | 985.00 KiB/s, done.
```

** Išsibandau `serman2`:
+
```
osboxes@ldvm1:~$ sudo serman/serman.py
----8><----------------------------------------------------------------------------------------------------><8----
Commands│  Services
────────┼─────────────────────────────────────────────────────────────────────────────────────────────────────────
enable  │  getty@tty2.service                                                                          running ● ▲
restart │  getty@tty6.service                                                                          running ● ▲
start   │  gpu-manager.service                                                                            dead
status  │  graphical.target                                                                               dead
        │  grub-common.service                                                                          exited ●
        │  grub-initrd-fallback.service                                                                   dead
        │  halt.target
        │  hibernate.target
        │  home.mount                                                                                  mounted ●
        │  hwclock.service
        │  hybrid-sleep.target
        │  ifup@.service
        │  ifup@enp0s8.service                                                                          exited ● ▲
        │  ifupdown-pre.service                                                                         exited ●
        │  ifupdown-wait-online.service
────────┴─────────────────────────────────────────────────────────────────────────────────────────────────────────
query service status (display output with F2)                                                  [press F3 for help]
```

** Deja, įrankis `serman2` turi trūkumų:

*** Ne visada teisingai nuskaito tarnybų `Enabled` būseną.

*** Taip pat šios būsenos perjungimui (ir kitiems veiksmams) naudoja ne visai intuityvų UI:

**** pagalba kviečiama klavišu `F3`;
**** veiksmo tipas pasirenkamas kairiame stulpelyje, tarnybos – sąraše dešinėje;
**** tarp jų persijungiama klavišais `Right`, `Left`;
**** tarnybas veiksmui įvykdyti reikia pasirinkti klavišu `Space`;
**** veiksmas įvykdymomas klavišu `Enter`;
**** rezultatas pasižiūrimas klavišus `F3` atskirame vaizde;
**** grįžtama į pradinį vaizdą paspaudus `Enter`;
**** programa uždaroma paspaudus `Ctrl-C`;
**** užuominos (angl. _Hint_) eilutė pradingsta po pirmojo vaizdo perjungimo ir grįžimo.

*** Taip pat įrankis rodo ne tik tarnybų (`.service`), bet ir kitų SystemD vienetų būsenas:

**** `.automount`
**** `.device`
**** `.mount`
**** `.path`
**** `.scope`
**** `.slice`
**** `.socket`
**** `.swap`
**** `.target`
**** `.timer`

* Susirandu kitą įrankį, `chkservice`

** Diegiu:
+
```
osboxes@ldvm1:~$ apt-cache search chkservice
chkservice - Tool for managing systemd units
osboxes@ldvm1:~$ 
osboxes@ldvm1:~$ sudo apt-get install chkservice
Reading package lists... Done
Building dependency tree       
Reading state information... Done
The following NEW packages will be installed:
  chkservice
0 upgraded, 1 newly installed, 0 to remove and 159 not upgraded.
Need to get 41.3 kB of archives.
After this operation, 188 kB of additional disk space will be used.
Get:1 http://us.archive.ubuntu.com/ubuntu focal/universe amd64 chkservice amd64 0.3-1build1 [41.3 kB]
Fetched 41.3 kB in 1s (58.7 kB/s)
Selecting previously unselected package chkservice.
(Reading database ... 192778 files and directories currently installed.)
Preparing to unpack .../chkservice_0.3-1build1_amd64.deb ...
Unpacking chkservice (0.3-1build1) ...
Setting up chkservice (0.3-1build1) ...
Processing triggers for man-db (2.9.1-1) ...
```

** Išbandau `chkservice`:
+
```
osboxes@ldvm1:~/src$ sudo chkservice
----8><----------------------------------------------------------------------------------------------------><8----
 Failed: Connection reset by peer                                                                                 
                                                                                                                  
  -m-     kbd.service                                     kbd.service                                             
  [x]  >  kerneloops.service                              Tool to automatically collect and submit kernel crash   
  [x]  =  keyboard-setup.service                          Set the console keyboard layout                         
  [s]  =  kmod-static-nodes.service                       Create list of static device nodes for the current ker  
  [s]     kmod.service                                    /lib/systemd/system/kmod.service                        
  [s]  =  logrotate.service                               Rotate log files                                        
> [x]  =  ModemManager.service                            Modem Manager                                          <
  [s]  =  man-db.service                                  Daily man-db regeneration                               
  [s]     modprobe@.service                               /lib/systemd/system/modprobe@.service                   
  [s]  =  modprobe@drm.service                            Load Kernel Module drm                                  
  [s]  =  motd-news.service                               Message of the Day                                      
  [x]  >  mysql.service                                   MySQL Community Server                                  
  [x]     NetworkManager-dispatcher.service               /lib/systemd/system/NetworkManager-dispatcher.service   
  [x]  =  NetworkManager-wait-online.service              Network Manager Wait Online                             
  [x]  >  NetworkManager.service                          Network Manager                                         
  [x]  =  netplan-ovs-cleanup.service                     OpenVSwitch configuration for cleanup                   
                                                                                                                  
                                                         92/533                                                   
----8><----------------------------------------------------------------------------------------------------><8----
```

** Norint uždrausti tarnybą ir paspaudus `Space`, gaunu klaidą `Failed: Connection reset by peer`.  +
   Taip yra dėl klaidos programoje: https://github.com/linuxenko/chkservice/issues/12

** Imu pataisytą programos kodą iš GitHub: https://github.com/nufeng1999/chkservice
+
```
osboxes@ldvm1:~/src$ git clone https://github.com/nufeng74/chkservice.git
Cloning into 'chkservice'...
remote: Enumerating objects: 424, done.
remote: Counting objects: 100% (7/7), done.
remote: Compressing objects: 100% (6/6), done.
remote: Total 424 (delta 1), reused 4 (delta 1), pack-reused 417
Receiving objects: 100% (424/424), 98.22 KiB | 1.51 MiB/s, done.
Resolving deltas: 100% (264/264), done.

osboxes@ldvm1:~/src$ cd chkservice
osboxes@ldvm1:~/src/chkservice$ mkdir build
osboxes@ldvm1:~/src/chkservice$ cd build

osboxes@ldvm1:~/src/chkservice/build$ cmake -DCMAKE_INSTALL_PREFIX=/usr ..

Command 'cmake' not found, but can be installed with:

sudo snap install cmake  # version 3.20.5, or
sudo apt  install cmake  # version 3.16.3-1ubuntu1

See 'snap info cmake' for additional versions.
```

** Diegiu kūrimo priemones:
+
```
osboxes@ldvm1:~/src/chkservice/build$ sudo apt-get install cmake g++ libsystemd-dev libncurses-dev
Reading package lists... Done
Building dependency tree       
Reading state information... Done
Suggested packages:
  cmake-doc ninja-build g++-multilib ncurses-doc
The following NEW packages will be installed:
  cmake g++ libncurses-dev libsystemd-dev
0 upgraded, 4 newly installed, 0 to remove and 153 not upgraded.
Need to get 0 B/4,256 kB of archives.
After this operation, 22.6 MB of additional disk space will be used.
Selecting previously unselected package cmake.
(Reading database ... 196958 files and directories currently installed.)
Preparing to unpack .../cmake_3.16.3-1ubuntu1_amd64.deb ...
Unpacking cmake (3.16.3-1ubuntu1) ...
Selecting previously unselected package g++.
Preparing to unpack .../g++_4%3a9.3.0-1ubuntu2_amd64.deb ...
Unpacking g++ (4:9.3.0-1ubuntu2) ...
Selecting previously unselected package libncurses-dev:amd64.
Preparing to unpack .../libncurses-dev_6.2-0ubuntu2_amd64.deb ...
Unpacking libncurses-dev:amd64 (6.2-0ubuntu2) ...
Selecting previously unselected package libsystemd-dev:amd64.
Preparing to unpack .../libsystemd-dev_245.4-4ubuntu3.7_amd64.deb ...
Unpacking libsystemd-dev:amd64 (245.4-4ubuntu3.7) ...
Setting up libncurses-dev:amd64 (6.2-0ubuntu2) ...
Setting up g++ (4:9.3.0-1ubuntu2) ...
update-alternatives: using /usr/bin/g++ to provide /usr/bin/c++ (c++) in auto mode
Setting up cmake (3.16.3-1ubuntu1) ...
Setting up libsystemd-dev:amd64 (245.4-4ubuntu3.7) ...
Processing triggers for man-db (2.9.1-1) ...
```

** Kompiliuoju įrankį:
+
```
osboxes@ldvm1:~/src/chkservice/build$ cmake ..
-- The C compiler identification is GNU 9.3.0
-- The CXX compiler identification is GNU 9.3.0
-- Check for working C compiler: /usr/bin/cc
-- Check for working C compiler: /usr/bin/cc -- works
-- Detecting C compiler ABI info
-- Detecting C compiler ABI info - done
-- Detecting C compile features
-- Detecting C compile features - done
-- Check for working CXX compiler: /usr/bin/c++
-- Check for working CXX compiler: /usr/bin/c++ -- works
-- Detecting CXX compiler ABI info
-- Detecting CXX compiler ABI info - done
-- Detecting CXX compile features
-- Detecting CXX compile features - done
-- DEBUG mode disabled
-- Local build
-- Found PkgConfig: /usr/bin/pkg-config (found version "0.29.1") 
-- Checking for module 'libsystemd'
--   Found libsystemd, version 245
-- Checking for module 'ncurses'
--   Found ncurses, version 6.2.20200212
-- Configuring done
-- Generating done
-- Build files have been written to: /home/osboxes/src/chkservice/build

osboxes@ldvm1:~/src/chkservice/build$ make chkservice
Scanning dependencies of target CHKSYSTEMD
[ 10%] Building CXX object src/CMakeFiles/CHKSYSTEMD.dir/chk-systemd.cpp.o
[ 20%] Building CXX object src/CMakeFiles/CHKSYSTEMD.dir/chk-systemd-utils.cpp.o
[ 30%] Linking CXX static library libCHKSYSTEMD.a
[ 30%] Built target CHKSYSTEMD
[ 40%] Building CXX object src/CMakeFiles/CHKCTL.dir/chk-ctl.cpp.o
[ 50%] Linking CXX static library libCHKCTL.a
[ 50%] Built target CHKCTL
[ 60%] Building CXX object src/CMakeFiles/CHKUI.dir/chk-wmain.cpp.o
  ...
[ 70%] Building CXX object src/CMakeFiles/CHKUI.dir/chk-wutils.cpp.o
[ 80%] Linking CXX static library libCHKUI.a
[ 80%] Built target CHKUI
[ 90%] Building CXX object src/CMakeFiles/chkservice.dir/chkservice.cpp.o
[100%] Linking CXX executable chkservice
[100%] Built target chkservice
```

** Patikrinu įrankį:
+
```
osboxes@ldvm1:~/src/chkservice/build$ ll src/chkservice
-rwxrwxr-x 1 osboxes osboxes 94344 Jul  4 15:27 src/chkservice*

osboxes@ldvm1:~/src/chkservice/build$ sudo src/chkservice
----8><----------------------------------------------------------------------------------------------------><8----
                                                                                                                  
                                                                                                                  
  [x]  >  irqbalance.service                              irqbalance daemon                                       
  -m-     kbd.service                                     kbd.service                                             
  [x]  >  kerneloops.service                              Tool to automatically collect and submit kernel crash   
  [x]  =  keyboard-setup.service                          Set the console keyboard layout                         
  [s]  =  kmod-static-nodes.service                       Create list of static device nodes for the current ker  
  [s]     kmod.service                                    /lib/systemd/system/kmod.service                        
  [s]  =  logrotate.service                               Rotate log files                                        
> [ ]     ModemManager.service                            /lib/systemd/system/ModemManager.service               <
  [s]  =  man-db.service                                  Daily man-db regeneration                               
  [s]     modprobe@.service                               /lib/systemd/system/modprobe@.service                   
  [s]  =  modprobe@drm.service                            Load Kernel Module drm                                  
  [s]  =  motd-news.service                               Message of the Day                                      
  [x]  >  mysql.service                                   MySQL Community Server                                  
  [x]     NetworkManager-dispatcher.service               /lib/systemd/system/NetworkManager-dispatcher.service   
  [x]  =  NetworkManager-wait-online.service              Network Manager Wait Online                             
  [x]  >  NetworkManager.service                          Network Manager                                         
                                                                                                                  
                                                         91/532                                                   
----8><----------------------------------------------------------------------------------------------------><8----
```
+
Ties `ModemManager` paspaudus `Space` tarnyba dabar jau iškart išsijungia.


#### X. SSH serverio instaliavimas

Ieškau programinės įrangos paketo:

```
osboxes@osboxes:~$ apt search ssh
Sorting...
Full Text Search...
4pane/focal 6.0-1build1 amd64
  four-pane detailed-list file manager

agent-transfer/focal 0.41-1ubuntu1 amd64
  copy a secret key from GnuPG's gpg-agent to OpenSSH's ssh-agent
  ...
zsnapd-rcmd/focal,focal 0.8.11h-1ubuntu2 all
  Remote sshd command checker for ZFS Snapshot Daemon

zssh/focal 1.5c.debian.1-7build2 amd64
  interactive file transfers over ssh

```

Diegiu `OpenSSH` serverį:

```
osboxes@osboxes:~$ sudo apt install openssh-server
sudo apt install openssh-server
Reading package lists... Done
Building dependency tree
Reading state information... Done
The following additional packages will be installed:
  ncurses-term openssh-client openssh-sftp-server ssh-import-id
Suggested packages:
  keychain libpam-ssh monkeysphere ssh-askpass molly-guard
The following NEW packages will be installed:
  ncurses-term openssh-server openssh-sftp-server ssh-import-id
The following packages will be upgraded:
  openssh-client
1 upgraded, 4 newly installed, 0 to remove and 261 not upgraded.
Need to get 1,100 kB/1,359 kB of archives.
After this operation, 6,010 kB of additional disk space will be used.
Get:1 http://us.archive.ubuntu.com/ubuntu focal-updates/main amd64 openssh-client amd64 1:8.2p1-4ubuntu0.2 [671 kB]
Get:2 http://us.archive.ubuntu.com/ubuntu focal-updates/main amd64 openssh-sftp-server amd64 1:8.2p1-4ubuntu0.2 [51.5 kB]
Get:3 http://us.archive.ubuntu.com/ubuntu focal-updates/main amd64 openssh-server amd64 1:8.2p1-4ubuntu0.2 [377 kB]
Fetched 1,100 kB in 3s (350 kB/s)
Preconfiguring packages ...
(Reading database ... 145074 files and directories currently installed.)
  ...
Setting up openssh-sftp-server (1:8.2p1-4ubuntu0.2) ...
Setting up openssh-server (1:8.2p1-4ubuntu0.2) ...

Creating config file /etc/ssh/sshd_config with new version
Creating SSH2 RSA key; this may take some time ...
3072 SHA256:q7is6Llfa0sm7vxlzTgNUUInZNOuRZ5EoRe1VPNEzNg root@osboxes (RSA)
Creating SSH2 ECDSA key; this may take some time ...
256 SHA256:YG+pWX5PORlrH0zmBOcPAxGQOw5cpiE8HMISFrQ6xxA root@osboxes (ECDSA)
Creating SSH2 ED25519 key; this may take some time ...
256 SHA256:SSYtj9I+qp5yLhXGL3AdbncN3lOnSbJ1C4cqQ2UzTkI root@osboxes (ED25519)

Progress: [ 90%] [####################################################......]
Created symlink /etc/systemd/system/sshd.service → /lib/systemd/system/ssh.service.
Created symlink /etc/systemd/system/multi-user.target.wants/ssh.service → /lib/systemd/system/ssh.service.
rescue-ssh.target is a disabled or a static unit, not starting it.
Processing triggers for systemd (245.4-4ubuntu3.4) ...
Processing triggers for man-db (2.9.1-1) ...
Processing triggers for ufw (0.36-6) ...
```


### Sunkumai ir atsakymai į klausimus


### Duotosios `iptables` komandos aprašymas: `TODO`


##### Pavyzdys


### `iptables` tarsegmentinio ekrano scenarijaus analizė (darbas grupėje)

