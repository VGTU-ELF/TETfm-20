### Darbo Tikslas

- [ ] Parengti ir išbandyti _Snort 2.9.18_ atakų atpažinimo sistemą.


### Trumpas atlikto darbo aptarimas

#### 1. Tinklo paruošimas

Išvalau `iptables` nustatymus:

```
osboxes@ldvm1:~$ sudo iptables -F
osboxes@ldvm1:~$ 
```

* Iškart iškilo sunkumas – užstrigo SSH ryšys ir po ilgo laiko SSH klientas atsijungė:
+
```
osboxes@ldvm1:~$ 
osboxes@ldvm1:~$ packet_write_wait: Connection to 192.168.10.14 port 22: Broken pipe
```

* Priežasčių supratimui prisijungiau per Serial konsolę ir pasinaudojau `tcpdump` programa:
+
```
osboxes@ldvm1:~$ sudo tcpdump -ni any
sudo tcpdump -ni any
tcpdump: verbose output suppressed, use -v or -vv for full protocol decode
listening on any, link-type LINUX_SLL (Linux cooked v1), capture size 262144 bytes
22:35:57.299726 IP 192.168.10.14.22 > 192.168.10.254.40526: Flags [P.], seq 4070427175:4070427275, ack 809347258, win 501, options [nop,nop,TS val 1151414038 ecr 28314383], length 100
22:35:57.299901 IP 192.168.10.254.40526 > 192.168.10.14.22: Flags [.], ack 100, win 466, options [nop,nop,TS val 28315249 ecr 1151414038,nop,nop,sack 1 {0:100}], length 0
22:35:58.131852 IP 192.168.10.14.22 > 192.168.10.254.40526: Flags [P.], seq 0:100, ack 1, win 501, options [nop,nop,TS val 1151414870 ecr 28314383], length 100
22:35:58.134467 IP 192.168.10.254.40526 > 192.168.10.14.22: Flags [.], ack 100, win 466, options [nop,nop,TS val 28316095 ecr 1151414870,nop,nop,sack 1 {0:100}], length 0
22:35:59.795988 IP 192.168.10.14.22 > 192.168.10.254.40526: Flags [P.], seq 0:100, ack 1, win 501, options [nop,nop,TS val 1151416534 ecr 28314383], length 100
22:35:59.798233 IP 192.168.10.254.40526 > 192.168.10.14.22: Flags [.], ack 100, win 466, options [nop,nop,TS val 28317788 ecr 1151416534,nop,nop,sack 1 {0:100}], length 0
22:36:03.091852 IP 192.168.10.14.22 > 192.168.10.254.40526: Flags [P.], seq 0:100, ack 1, win 501, options [nop,nop,TS val 1151419830 ecr 28314383], length 100
22:36:03.093223 IP 192.168.10.254.40526 > 192.168.10.14.22: Flags [.], ack 100, win 466, options [nop,nop,TS val 28321139 ecr 1151419830,nop,nop,sack 1 {0:100}], length 0
22:36:09.747774 IP 192.168.10.14.22 > 192.168.10.254.40526: Flags [P.], seq 0:100, ack 1, win 501, options [nop,nop,TS val 1151426486 ecr 28314383], length 100
22:36:09.748032 IP 192.168.10.254.40526 > 192.168.10.14.22: Flags [.], ack 100, win 466, options [nop,nop,TS val 28327908 ecr 1151426486,nop,nop,sack 1 {0:100}], length 0
22:36:23.059826 IP 192.168.10.14.22 > 192.168.10.254.40526: Flags [P.], seq 0:100, ack 1, win 501, options [nop,nop,TS val 1151439798 ecr 28314383], length 100
22:36:23.060319 IP 192.168.10.254.40526 > 192.168.10.14.22: Flags [.], ack 100, win 466, options [nop,nop,TS val 28341446 ecr 1151439798,nop,nop,sack 1 {0:100}], length 0
22:36:49.695812 IP 192.168.10.14.22 > 192.168.10.254.40526: Flags [P.], seq 0:100, ack 1, win 501, options [nop,nop,TS val 1151466434 ecr 28314383], length 100
22:36:49.696170 IP 192.168.10.254.40526 > 192.168.10.14.22: Flags [.], ack 100, win 466, options [nop,nop,TS val 28368534 ecr 1151466434,nop,nop,sack 1 {0:100}], length 0
22:36:54.614139 ARP, Request who-has 192.168.10.14 tell 192.168.10.254, length 46
22:36:54.614163 ARP, Reply 192.168.10.14 is-at 08:00:27:40:2c:f6, length 28
22:36:54.803813 ARP, Request who-has 192.168.10.254 tell 192.168.10.14, length 28
22:36:54.804052 ARP, Reply 192.168.10.254 is-at 0a:00:27:00:00:00, length 46
22:37:42.948130 IP 192.168.10.14.22 > 192.168.10.254.40526: Flags [P.], seq 0:100, ack 1, win 501, options [nop,nop,TS val 1151519686 ecr 28314383], length 100
22:37:42.948395 IP 192.168.10.254.40526 > 192.168.10.14.22: Flags [.], ack 100, win 466, options [nop,nop,TS val 28422690 ecr 1151519686,nop,nop,sack 1 {0:100}], length 0
22:37:47.870393 ARP, Request who-has 192.168.10.14 tell 192.168.10.254, length 46
22:37:47.870439 ARP, Reply 192.168.10.14 is-at 08:00:27:40:2c:f6, length 28
22:37:48.051718 ARP, Request who-has 192.168.10.254 tell 192.168.10.14, length 28
22:37:48.052034 ARP, Reply 192.168.10.254 is-at 0a:00:27:00:00:00, length 46
```

* Matyti, kad:

** virtualus kompiuteris fiziniam kompiuteriui siunčia duomenų bloką per TCP;
** fizinis kompiuteris per TCP siunčia patvirtinimus, kad duomenis gavo;
** ir veiksmai kartojasi su vis ilgėjančiu intervalu tarp pasikartojimų.

* Peržiūrėjus `iptables` matyti, kad tai įvyksta dėl grandyje `INPUT` pasilikusio `POLICY = DROP` nustatymo:
+
```
osboxes@ldvm1:~$ sudo iptables --list -n
Chain INPUT (policy DROP)
target     prot opt source               destination         
ACCEPT     tcp  --  0.0.0.0/0            192.168.10.14        tcp dpt:22
ACCEPT     tcp  --  0.0.0.0/0            192.168.10.14        tcp dpt:443

Chain FORWARD (policy DROP)
target     prot opt source               destination         

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination         
```

* Tad jei tarpsegmentinį filtrą nustatome scenarijaus pagalba, jį išvalyti reikėtų taip pat:
+
```
osboxes@ldvm1:~$ sudo /etc/init.d/myfirewall stop
sudo /etc/init.d/myfirewall stop
Stopping firewall (flushing rules)
```

* Tikrinu ryšį:
+
```
[p@localhost ~]$ ssh osboxes@192.168.10.14
osboxes@192.168.10.14's password: 
Welcome to Ubuntu 20.04.2 LTS (GNU/Linux 5.8.0-59-generic x86_64)

 * Documentation:  https://help.ubuntu.com
 * Management:     https://landscape.canonical.com
 * Support:        https://ubuntu.com/advantage

154 updates can be installed immediately.
0 of these updates are security updates.
To see these additional updates run: apt list --upgradable

Failed to connect to https://changelogs.ubuntu.com/meta-release-lts. Check your Internet connection or proxy settings

Your Hardware Enablement Stack (HWE) is supported until April 2025.
Last login: Tue Jul  6 22:34:55 2021 from 192.168.10.254
osboxes@ldvm1:~$ 
```

* Ryšys atsistatė.

* 4LD aprašas šiam žingsniui nevisai korektiškas.

Tikrinu tinklo nustatymus:

```
osboxes@ldvm1:~$ ifconfig -a
enp0s3: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        ether 08:00:27:7e:da:b1  txqueuelen 1000  (Ethernet)
        RX packets 0  bytes 0 (0.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 0  bytes 0 (0.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

enp0s8: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 192.168.10.14  netmask 255.255.255.0  broadcast 192.168.10.255
        inet6 fe80::a00:27ff:fe40:2cf6  prefixlen 64  scopeid 0x20<link>
        ether 08:00:27:40:2c:f6  txqueuelen 1000  (Ethernet)
        RX packets 16428  bytes 1629872 (1.6 MB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 17379  bytes 1393784 (1.3 MB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

enp0s8:2: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 10.10.10.4  netmask 255.255.255.0  broadcast 10.10.10.255
        ether 08:00:27:40:2c:f6  txqueuelen 1000  (Ethernet)

lo: flags=73<UP,LOOPBACK,RUNNING>  mtu 65536
        inet 127.0.0.1  netmask 255.0.0.0
        inet6 ::1  prefixlen 128  scopeid 0x10<host>
        loop  txqueuelen 1000  (Local Loopback)
        RX packets 37  bytes 3595 (3.5 KB)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 37  bytes 3595 (3.5 KB)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

```
```
osboxes@ldvm1:~$ route -n
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
0.0.0.0         192.168.10.254  0.0.0.0         UG    0      0        0 enp0s8
10.10.10.0      0.0.0.0         255.255.255.0   U     0      0        0 enp0s8
169.254.0.0     0.0.0.0         255.255.0.0     U     1000   0        0 enp0s8
192.168.10.0    0.0.0.0         255.255.255.0   U     0      0        0 enp0s8
```

Tinklo nustatymai tvarkingi.

#### 2. Snort instaliavimas

Pereinu į išeities tekstų direktoriją:

```
osboxes@ldvm1:~$ cd /usr/local/src/
osboxes@ldvm1:/usr/local/src$ 
```

* Siunčiu Snort ir iškart antra kliūtis:
+
```
osboxes@ldvm1:/usr/local/src$ wget https://www.snort.org/downloads/snort/snort-2.9.18.tar.gz
--2021-07-06 23:11:27--  https://www.snort.org/downloads/snort/snort-2.9.18.tar.gz
Resolving www.snort.org (www.snort.org)... 104.18.139.9, 104.18.138.9, 2606:4700::6812:8b09, ...
Connecting to www.snort.org (www.snort.org)|104.18.139.9|:443... connected.
HTTP request sent, awaiting response... 302 Found
Location: https://snort-org-site.s3.amazonaws.com/production/release_files/files/000/018/474/original/snort-2.9.18.tar.gz?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAIXACIED2SPMSC7GA%2F20210706%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20210706T201127Z&X-Amz-Expires=3600&X-Amz-SignedHeaders=host&X-Amz-Signature=56f418bb145628cfcf085140ffdcd693b1dbf5deb116d8fac3117c594e7c1a8f [following]
--2021-07-06 23:11:28--  https://snort-org-site.s3.amazonaws.com/production/release_files/files/000/018/474/original/snort-2.9.18.tar.gz?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAIXACIED2SPMSC7GA%2F20210706%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20210706T201127Z&X-Amz-Expires=3600&X-Amz-SignedHeaders=host&X-Amz-Signature=56f418bb145628cfcf085140ffdcd693b1dbf5deb116d8fac3117c594e7c1a8f
Resolving snort-org-site.s3.amazonaws.com (snort-org-site.s3.amazonaws.com)... 52.217.137.153
Connecting to snort-org-site.s3.amazonaws.com (snort-org-site.s3.amazonaws.com)|52.217.137.153|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 6909928 (6.6M) [binary/octet-stream]
snort-2.9.18.tar.gz: Permission denied

Cannot write to ‘snort-2.9.18.tar.gz’ (Success).`
```

* Tikrinu teises:
+
```
osboxes@ldvm1:/usr/local/src$ ll -d .
drwxr-xr-x 2 root root 4096 Feb  9 20:47 ./

osboxes@ldvm1:/usr/local/src$ id
uid=1000(osboxes) gid=1000(osboxes) groups=1000(osboxes),4(adm),24(cdrom),27(sudo),30(dip),46(plugdev),120(lpadmin),131(lxd),132(sambashare)
```

* Ir jas pakeičiu:
+
```
osboxes@ldvm1:/usr/local/src$ sudo chown osboxes:osboxes .

osboxes@ldvm1:/usr/local/src$ ll -d .
drwxr-xr-x 2 osboxes osboxes 4096 Feb  9 20:47 ./
```

Parsisiunčiu Snort:

```
osboxes@ldvm1:/usr/local/src$ wget https://www.snort.org/downloads/snort/snort-2.9.18.tar.gz
--2021-07-06 23:17:38--  https://www.snort.org/downloads/snort/snort-2.9.18.tar.gz
Resolving www.snort.org (www.snort.org)... 104.18.138.9, 104.18.139.9, 2606:4700::6812:8b09, ...
Connecting to www.snort.org (www.snort.org)|104.18.138.9|:443... connected.
HTTP request sent, awaiting response... 302 Found
Location: https://snort-org-site.s3.amazonaws.com/production/release_files/files/000/018/474/original/snort-2.9.18.tar.gz?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAIXACIED2SPMSC7GA%2F20210706%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20210706T201740Z&X-Amz-Expires=3600&X-Amz-SignedHeaders=host&X-Amz-Signature=5dd830302594716f459629ffbc4e1479e7e61b2d7534516a1422ac482626c025 [following]
--2021-07-06 23:17:39--  https://snort-org-site.s3.amazonaws.com/production/release_files/files/000/018/474/original/snort-2.9.18.tar.gz?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAIXACIED2SPMSC7GA%2F20210706%2Fus-east-1%2Fs3%2Faws4_request&X-Amz-Date=20210706T201740Z&X-Amz-Expires=3600&X-Amz-SignedHeaders=host&X-Amz-Signature=5dd830302594716f459629ffbc4e1479e7e61b2d7534516a1422ac482626c025
Resolving snort-org-site.s3.amazonaws.com (snort-org-site.s3.amazonaws.com)... 52.216.239.139
Connecting to snort-org-site.s3.amazonaws.com (snort-org-site.s3.amazonaws.com)|52.216.239.139|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 6909928 (6.6M) [binary/octet-stream]
Saving to: ‘snort-2.9.18.tar.gz’

snort-2.9.18.tar.gz      100%[===============================>]   6.59M  1.14MB/s    in 8.7s    

2021-07-06 23:17:49 (779 KB/s) - ‘snort-2.9.18.tar.gz’ saved [6909928/6909928]
```

Išarchyvuoju:

```
osboxes@ldvm1:/usr/local/src$ tar xvzf snort-2.9.18.tar.gz
snort-2.9.18/
snort-2.9.18/Makefile.in
snort-2.9.18/Makefile.am
snort-2.9.18/configure
snort-2.9.18/configure.in
  ...
snort-2.9.18/tools/u2streamer/UnifiedLog.h
snort-2.9.18/tools/u2streamer/sf_error.c
snort-2.9.18/tools/u2streamer/sf_error.h
snort-2.9.18/depcomp
osboxes@ldvm1:/usr/local/src$ 
```

Pereinu į išarchyvuotą direktoriją:

```
osboxes@ldvm1:/usr/local/src$ cd snort-2.9.18/
osboxes@ldvm1:/usr/local/src/snort-2.9.18$ 
```

Peržiūriu instaliavimo rekomendacijas:

```
osboxes@ldvm1:/usr/local/src/snort-2.9.18$ wc -l doc/INSTALL
683 doc/INSTALL

osboxes@ldvm1:/usr/local/src/snort-2.9.18$ nano doc/INSTALL
[1]+  Stopped                 nano doc/INSTALL
```

* Konfigūruoju kompiliatorių, iškyla sunkumas:
+
```
osboxes@ldvm1:/usr/local/src/snort-2.9.18$ ./configure --with-mysql --enable-dynamicplugin
configure: WARNING: unrecognized options: --with-mysql, --enable-dynamicplugin
checking for a BSD-compatible install... /usr/bin/install -c
checking whether build environment is sane... yes
checking for a thread-safe mkdir -p... /usr/bin/mkdir -p
checking for gawk... no
checking for mawk... mawk
  ...
checking for pfring_open in -lpfring... no
checking for pfring_open in -lpcap... no

   ERROR!  Libpcap library/headers (libpcap.a (or .so)/pcap.h)
   not found, go get it from http://www.tcpdump.org
   or use the --with-libpcap-* options, if you have it installed
   in unusual place.  Also check if your libpcap depends on another
   shared library that may be installed in an unusual place
```

* Įdiegiu 2LD metu praleistus ir dabar trūkstančius paketus:
+
```
osboxes@ldvm1:/usr/local/src/snort-2.9.18$ sudo apt-get install libnet1 libnet1-dev libpcre3 libpcre3-dev libpcap0.8 libpcap0.8-dev
Reading package lists... Done
Building dependency tree       
Reading state information... Done
libpcap0.8 is already the newest version (1.9.1-3).
libpcap0.8 set to manually installed.
libpcre3 is already the newest version (2:8.39-12build1).
libpcre3 set to manually installed.
The following additional packages will be installed:
  libpcre16-3 libpcre32-3 libpcrecpp0v5
The following NEW packages will be installed:
  libnet1 libnet1-dev libpcap0.8-dev libpcre16-3 libpcre3-dev libpcre32-3 libpcrecpp0v5
0 upgraded, 7 newly installed, 0 to remove and 153 not upgraded.
Need to get 1,234 kB of archives.
After this operation, 5,059 kB of additional disk space will be used.
Do you want to continue? [Y/n] y
Get:1 http://us.archive.ubuntu.com/ubuntu focal/main amd64 libnet1 amd64 1.1.6+dfsg-3.1build1 [43.3 kB]
Get:2 http://us.archive.ubuntu.com/ubuntu focal/main amd64 libnet1-dev amd64 1.1.6+dfsg-3.1build1 [101 kB]
Get:3 http://us.archive.ubuntu.com/ubuntu focal/main amd64 libpcap0.8-dev amd64 1.9.1-3 [244 kB]
Get:4 http://us.archive.ubuntu.com/ubuntu focal/main amd64 libpcre16-3 amd64 2:8.39-12build1 [150 kB]
Get:5 http://us.archive.ubuntu.com/ubuntu focal/main amd64 libpcre32-3 amd64 2:8.39-12build1 [140 kB]
Get:6 http://us.archive.ubuntu.com/ubuntu focal/main amd64 libpcrecpp0v5 amd64 2:8.39-12build1 [15.5 kB]
Get:7 http://us.archive.ubuntu.com/ubuntu focal/main amd64 libpcre3-dev amd64 2:8.39-12build1 [540 kB]
Fetched 1,234 kB in 4s (345 kB/s)     
Selecting previously unselected package libnet1:amd64.
(Reading database ... 197632 files and directories currently installed.)
Preparing to unpack .../0-libnet1_1.1.6+dfsg-3.1build1_amd64.deb ...
Unpacking libnet1:amd64 (1.1.6+dfsg-3.1build1) ...
Selecting previously unselected package libnet1-dev.
Preparing to unpack .../1-libnet1-dev_1.1.6+dfsg-3.1build1_amd64.deb ...
Unpacking libnet1-dev (1.1.6+dfsg-3.1build1) ...
Selecting previously unselected package libpcap0.8-dev:amd64.
Preparing to unpack .../2-libpcap0.8-dev_1.9.1-3_amd64.deb ...
Unpacking libpcap0.8-dev:amd64 (1.9.1-3) ...
Selecting previously unselected package libpcre16-3:amd64.
Preparing to unpack .../3-libpcre16-3_2%3a8.39-12build1_amd64.deb ...
Unpacking libpcre16-3:amd64 (2:8.39-12build1) ...
Selecting previously unselected package libpcre32-3:amd64.
Preparing to unpack .../4-libpcre32-3_2%3a8.39-12build1_amd64.deb ...
Unpacking libpcre32-3:amd64 (2:8.39-12build1) ...
Selecting previously unselected package libpcrecpp0v5:amd64.
Preparing to unpack .../5-libpcrecpp0v5_2%3a8.39-12build1_amd64.deb ...
Unpacking libpcrecpp0v5:amd64 (2:8.39-12build1) ...
Selecting previously unselected package libpcre3-dev:amd64.
Preparing to unpack .../6-libpcre3-dev_2%3a8.39-12build1_amd64.deb ...
Unpacking libpcre3-dev:amd64 (2:8.39-12build1) ...
Setting up libpcrecpp0v5:amd64 (2:8.39-12build1) ...
Setting up libpcre16-3:amd64 (2:8.39-12build1) ...
Setting up libpcap0.8-dev:amd64 (1.9.1-3) ...
Setting up libnet1:amd64 (1.1.6+dfsg-3.1build1) ...
Setting up libpcre32-3:amd64 (2:8.39-12build1) ...
Setting up libpcre3-dev:amd64 (2:8.39-12build1) ...
Setting up libnet1-dev (1.1.6+dfsg-3.1build1) ...
Processing triggers for man-db (2.9.1-1) ...
Processing triggers for libc-bin (2.31-0ubuntu9.2) ...
```

* Taisau, bet dar nesusikonfigūravo:
+
```
osboxes@ldvm1:/usr/local/src/snort-2.9.18$ ./configure --with-mysql --enable-dynamicplugin
configure: WARNING: unrecognized options: --with-mysql, --enable-dynamicplugin
checking for a BSD-compatible install... /usr/bin/install -c
checking whether build environment is sane... yes
checking for a thread-safe mkdir -p... /usr/bin/mkdir -p
checking for gawk... no
checking for mawk... mawk
  ...
checking for SHA256_Init in -lcrypto... yes
checking for MD5_Init in -lcrypto... yes
checking dnet.h usability... no
checking dnet.h presence... no
checking for dnet.h... no
checking dumbnet.h usability... no
checking dumbnet.h presence... no
checking for dumbnet.h... no

   ERROR!  dnet header not found, go get it from
   http://code.google.com/p/libdnet/ or use the --with-dnet-*
   options, if you have it installed in an unusual place
```

* Trūksta `libdnet`.

* Ieškau ir diegiu `libdnet`:
+
```
osboxes@ldvm1:/usr/local/src/snort-2.9.18$ apt-cache search libdnet
dnet-common - Base package for Linux DECnet
libdnet - DECnet Libraries
libdnet-dev - DECnet development libraries & Headers
libdumbnet-dev - dumb, portable networking library -- development files
libdumbnet1 - dumb, portable networking library -- shared library
libnet-libdnet-perl - interface to libdumbnet's low-level network functions
libnet-libdnet6-perl - module to add IPv6 support to Net::Libdnet
osboxes@ldvm1:/usr/local/src/snort-2.9.18$ sudo apt-get install libdnet libdnet-dev 
Reading package lists... Done
Building dependency tree       
Reading state information... Done
Suggested packages:
  dnet-common
The following NEW packages will be installed:
  libdnet libdnet-dev
0 upgraded, 2 newly installed, 0 to remove and 153 not upgraded.
Need to get 357 kB of archives.
After this operation, 996 kB of additional disk space will be used.
Get:1 http://us.archive.ubuntu.com/ubuntu focal/universe amd64 libdnet amd64 2.65build2 [60.1 kB]
Get:2 http://us.archive.ubuntu.com/ubuntu focal/universe amd64 libdnet-dev amd64 2.65build2 [297 kB]
Fetched 357 kB in 1s (248 kB/s)      
Selecting previously unselected package libdnet:amd64.
(Reading database ... 197909 files and directories currently installed.)
Preparing to unpack .../libdnet_2.65build2_amd64.deb ...
Unpacking libdnet:amd64 (2.65build2) ...
Selecting previously unselected package libdnet-dev:amd64.
Preparing to unpack .../libdnet-dev_2.65build2_amd64.deb ...
Unpacking libdnet-dev:amd64 (2.65build2) ...
Setting up libdnet:amd64 (2.65build2) ...
Setting up libdnet-dev:amd64 (2.65build2) ...
Processing triggers for man-db (2.9.1-1) ...
Processing triggers for libc-bin (2.31-0ubuntu9.2) ...
```

* Konfigūruoju kompiliatorių, klaida išlieka:
+
```
osboxes@ldvm1:/usr/local/src/snort-2.9.18$ ./configure --with-mysql --enable-dynamicplugin
configure: WARNING: unrecognized options: --with-mysql, --enable-dynamicplugin
checking for a BSD-compatible install... /usr/bin/install -c
checking whether build environment is sane... yes
checking for a thread-safe mkdir -p... /usr/bin/mkdir -p
checking for gawk... no
checking for mawk... mawk
  ...
checking for SHA256_Init in -lcrypto... yes
checking for MD5_Init in -lcrypto... yes
checking dnet.h usability... no
checking dnet.h presence... no
checking for dnet.h... no
checking dumbnet.h usability... no
checking dumbnet.h presence... no
checking for dumbnet.h... no

   ERROR!  dnet header not found, go get it from
   http://code.google.com/p/libdnet/ or use the --with-dnet-*
   options, if you have it installed in an unusual place
```

* Tikrinu `INSTALL` faile nurodytą įrankį:
+
```
osboxes@ldvm1:/usr/local/src/snort-2.9.18$ dnet-config

Command 'dnet-config' not found, but can be installed with:

sudo apt install libdumbnet-dev
```

* Išmet `libdnet` paketus:
+
```
osboxes@ldvm1:/usr/local/src/snort-2.9.18$ sudo apt-get autoremove libdnet libdnet-dev 
Reading package lists... Done
Building dependency tree       
Reading state information... Done
The following packages will be REMOVED:
  libdnet libdnet-dev
0 upgraded, 0 newly installed, 2 to remove and 153 not upgraded.
After this operation, 996 kB disk space will be freed.
Do you want to continue? [Y/n] 
(Reading database ... 197958 files and directories currently installed.)
Removing libdnet-dev:amd64 (2.65build2) ...
Removing libdnet:amd64 (2.65build2) ...
Processing triggers for man-db (2.9.1-1) ...
Processing triggers for libc-bin (2.31-0ubuntu9.2) ...
```

* Diegiu `libdumbnet` paketus:
+
```
osboxes@ldvm1:/usr/local/src/snort-2.9.18$ sudo apt-get install libdumbnet-dev 
Reading package lists... Done
Building dependency tree       
Reading state information... Done
The following additional packages will be installed:
  libdumbnet1
The following NEW packages will be installed:
  libdumbnet-dev libdumbnet1
0 upgraded, 2 newly installed, 0 to remove and 153 not upgraded.
Need to get 81.8 kB of archives.
After this operation, 329 kB of additional disk space will be used.
Do you want to continue? [Y/n] y
Get:1 http://us.archive.ubuntu.com/ubuntu focal/universe amd64 libdumbnet1 amd64 1.12-9build1 [25.4 kB]
Get:2 http://us.archive.ubuntu.com/ubuntu focal/universe amd64 libdumbnet-dev amd64 1.12-9build1 [56.4 kB]
Fetched 81.8 kB in 1s (102 kB/s)     
Selecting previously unselected package libdumbnet1:amd64.
(Reading database ... 197909 files and directories currently installed.)
Preparing to unpack .../libdumbnet1_1.12-9build1_amd64.deb ...
Unpacking libdumbnet1:amd64 (1.12-9build1) ...
Selecting previously unselected package libdumbnet-dev.
Preparing to unpack .../libdumbnet-dev_1.12-9build1_amd64.deb ...
Unpacking libdumbnet-dev (1.12-9build1) ...
Setting up libdumbnet1:amd64 (1.12-9build1) ...
Setting up libdumbnet-dev (1.12-9build1) ...
Processing triggers for man-db (2.9.1-1) ...
Processing triggers for libc-bin (2.31-0ubuntu9.2) ...
```

* Konfigūruoju kompiliatorių, nauja klaida:

```
osboxes@ldvm1:/usr/local/src/snort-2.9.18$ ./configure --with-mysql --enable-dynamicplugin
configure: WARNING: unrecognized options: --with-mysql, --enable-dynamicplugin
checking for a BSD-compatible install... /usr/bin/install -c
checking whether build environment is sane... yes
checking for a thread-safe mkdir -p... /usr/bin/mkdir -p
checking for gawk... no
  ...
checking dumbnet.h presence... yes
checking for dumbnet.h... yes
checking for eth_set in -ldnet... no
checking for eth_set in -ldumbnet... yes
checking for dlsym in -ldl... yes
./configure: line 12576: daq-modules-config: command not found
checking for daq_load_modules in -ldaq_static... no

   ERROR!  daq_static library not found, go get it from
   http://www.snort.org/.
```

* Diegiu `libdaq`:

```
osboxes@ldvm1:/usr/local/src/snort-2.9.18$ daq-modules-config

Command 'daq-modules-config' not found, but can be installed with:

sudo apt install libdaq-dev

osboxes@ldvm1:/usr/local/src/snort-2.9.18$ sudo apt-get install libdaq-dev
Reading package lists... Done
Building dependency tree       
Reading state information... Done
The following additional packages will be installed:
  libdaq2
The following NEW packages will be installed:
  libdaq-dev libdaq2
0 upgraded, 2 newly installed, 0 to remove and 153 not upgraded.
Need to get 171 kB of archives.
After this operation, 651 kB of additional disk space will be used.
Do you want to continue? [Y/n] 
Get:1 http://us.archive.ubuntu.com/ubuntu focal/universe amd64 libdaq2 amd64 2.0.4-3build2 [65.2 kB]
Get:2 http://us.archive.ubuntu.com/ubuntu focal/universe amd64 libdaq-dev amd64 2.0.4-3build2 [106 kB]
Fetched 171 kB in 1s (124 kB/s) 
Selecting previously unselected package libdaq2.
(Reading database ... 197948 files and directories currently installed.)
Preparing to unpack .../libdaq2_2.0.4-3build2_amd64.deb ...
Unpacking libdaq2 (2.0.4-3build2) ...
Selecting previously unselected package libdaq-dev.
Preparing to unpack .../libdaq-dev_2.0.4-3build2_amd64.deb ...
Unpacking libdaq-dev (2.0.4-3build2) ...
Setting up libdaq2 (2.0.4-3build2) ...
Setting up libdaq-dev (2.0.4-3build2) ...
Processing triggers for libc-bin (2.31-0ubuntu9.2) ...
```

* Konfigūruoju kompiliatorių, dar viena klaida:
+
```
osboxes@ldvm1:/usr/local/src/snort-2.9.18$ ./configure --with-mysql --enable-dynamicplugin
configure: WARNING: unrecognized options: --with-mysql, --enable-dynamicplugin
checking for a BSD-compatible install... /usr/bin/install -c
checking whether build environment is sane... yes
checking for a thread-safe mkdir -p... /usr/bin/mkdir -p
checking for gawk... no
  ...
checking for inflate in -lz... yes
checking lzma.h usability... no
checking lzma.h presence... no
checking for lzma.h... no
checking for lzma_stream_decoder in -llzma... no

   ERROR!  flex not found.
   Get it from http://flex.sourceforge.net/
   (You may also try lex instead.)
```

* Diegiu `flex` įrankį:
+
```
osboxes@ldvm1:/usr/local/src/snort-2.9.18$ flex

Command 'flex' not found, but can be installed with:

sudo apt install flex      # version 2.6.4-6.2, or
sudo apt install flex-old  # version 2.5.4a-10ubuntu2

osboxes@ldvm1:/usr/local/src/snort-2.9.18$ sudo apt-get install flex
Reading package lists... Done
Building dependency tree       
Reading state information... Done
The following additional packages will be installed:
  libfl-dev libfl2 libsigsegv2 m4
Suggested packages:
  bison build-essential flex-doc m4-doc
The following NEW packages will be installed:
  flex libfl-dev libfl2 libsigsegv2 m4
0 upgraded, 5 newly installed, 0 to remove and 153 not upgraded.
Need to get 547 kB of archives.
After this operation, 1,530 kB of additional disk space will be used.
Do you want to continue? [Y/n] 
Get:1 http://us.archive.ubuntu.com/ubuntu focal/main amd64 libsigsegv2 amd64 2.12-2 [13.9 kB]
Get:2 http://us.archive.ubuntu.com/ubuntu focal/main amd64 m4 amd64 1.4.18-4 [199 kB]
Get:3 http://us.archive.ubuntu.com/ubuntu focal/main amd64 flex amd64 2.6.4-6.2 [317 kB]
Get:4 http://us.archive.ubuntu.com/ubuntu focal/main amd64 libfl2 amd64 2.6.4-6.2 [11.5 kB]
Get:5 http://us.archive.ubuntu.com/ubuntu focal/main amd64 libfl-dev amd64 2.6.4-6.2 [6,316 B]
Fetched 547 kB in 2s (274 kB/s) 
Selecting previously unselected package libsigsegv2:amd64.
(Reading database ... 197971 files and directories currently installed.)
Preparing to unpack .../libsigsegv2_2.12-2_amd64.deb ...
Unpacking libsigsegv2:amd64 (2.12-2) ...
Selecting previously unselected package m4.
Preparing to unpack .../archives/m4_1.4.18-4_amd64.deb ...
Unpacking m4 (1.4.18-4) ...
Selecting previously unselected package flex.
Preparing to unpack .../flex_2.6.4-6.2_amd64.deb ...
Unpacking flex (2.6.4-6.2) ...
Selecting previously unselected package libfl2:amd64.
Preparing to unpack .../libfl2_2.6.4-6.2_amd64.deb ...
Unpacking libfl2:amd64 (2.6.4-6.2) ...
Selecting previously unselected package libfl-dev:amd64.
Preparing to unpack .../libfl-dev_2.6.4-6.2_amd64.deb ...
Unpacking libfl-dev:amd64 (2.6.4-6.2) ...
Setting up libsigsegv2:amd64 (2.12-2) ...
Setting up libfl2:amd64 (2.6.4-6.2) ...
Setting up m4 (1.4.18-4) ...
Setting up flex (2.6.4-6.2) ...
Setting up libfl-dev:amd64 (2.6.4-6.2) ...
Processing triggers for libc-bin (2.31-0ubuntu9.2) ...
Processing triggers for man-db (2.9.1-1) ...
Processing triggers for install-info (6.7.0.dfsg.2-5) ...
```

* Vėl konfigūruoju kompiliatorių:
+
```
osboxes@ldvm1:/usr/local/src/snort-2.9.18$ ./configure --with-mysql --enable-dynamicplugin
configure: WARNING: unrecognized options: --with-mysql, --enable-dynamicplugin
checking for a BSD-compatible install... /usr/bin/install -c
checking whether build environment is sane... yes
checking for a thread-safe mkdir -p... /usr/bin/mkdir -p
checking for gawk... no
  ...
checking for lzma.h... no
checking for lzma_stream_decoder in -llzma... no

   ERROR!  bison not found.
   Get it from http://www.gnu.org/software/bison/
   (You may also try byacc or yacc instead.)
```

* Diegiu `bison`:
+
```
osboxes@ldvm1:/usr/local/src/snort-2.9.18$ bison

Command 'bison' not found, but can be installed with:

sudo apt install bison    # version 2:3.5.1+dfsg-1, or
sudo apt install bison++  # version 1.21.11-4build1

osboxes@ldvm1:/usr/local/src/snort-2.9.18$ sudo apt-get install bison
Reading package lists... Done
Building dependency tree       
Reading state information... Done
Suggested packages:
  bison-doc
The following NEW packages will be installed:
  bison
0 upgraded, 1 newly installed, 0 to remove and 153 not upgraded.
Need to get 657 kB of archives.
After this operation, 2,028 kB of additional disk space will be used.
Get:1 http://us.archive.ubuntu.com/ubuntu focal/main amd64 bison amd64 2:3.5.1+dfsg-1 [657 kB]
Fetched 657 kB in 2s (318 kB/s)
Selecting previously unselected package bison.
(Reading database ... 198128 files and directories currently installed.)
Preparing to unpack .../bison_2%3a3.5.1+dfsg-1_amd64.deb ...
Unpacking bison (2:3.5.1+dfsg-1) ...
Setting up bison (2:3.5.1+dfsg-1) ...
update-alternatives: using /usr/bin/bison.yacc to provide /usr/bin/yacc (yacc) in auto mode
Processing triggers for man-db (2.9.1-1) ...
```

* Vėl konfigūruoju kompiliatorių, šįkart be klaidų – tik perspėjimai :
+
```
osboxes@ldvm1:/usr/local/src/snort-2.9.18$ ./configure --with-mysql --enable-dynamicplugin
configure: WARNING: unrecognized options: --with-mysql, --enable-dynamicplugin
checking for a BSD-compatible install... /usr/bin/install -c
checking whether build environment is sane... yes
checking for a thread-safe mkdir -p... /usr/bin/mkdir -p
  ...
checking for pthread_tryjoin_np... yes
checking for pkg-config... /usr/bin/pkg-config
checking pkg-config is at least version 0.9.0... yes
checking for luajit... no

   ERROR!  LuaJIT library not found. Go get it from http://www.luajit.org/ (or)
   Try compiling without openAppId using '--disable-open-appid'
configure: error: "Fatal!"
```

* Šį sykį mėginu apsieiti be nurodytos bibliotekos (ir OpenAppID palaikymo):
  
+
```
osboxes@ldvm1:/usr/local/src/snort-2.9.18$ ./configure --with-mysql --enable-dynamicplugin --disable-open-appid
configure: WARNING: unrecognized options: --with-mysql, --enable-dynamicplugin
checking for a BSD-compatible install... /usr/bin/install -c
checking whether build environment is sane... yes
checking for a thread-safe mkdir -p... /usr/bin/mkdir -p
checking for gawk... no
  ...
ecking for lzma_stream_decoder in -llzma... no
checking for pthread_tryjoin_np... yes
checking for nghttp2_option_new in -lnghttp2... no

   Libnghttp2 library not found.
   Get it from https://nghttp2.org/

checking for linuxthreads... no
checking for yylex_destroy support... yes
checking for SFLINUX... no
checking for WRLINUX... no
checking that generated files are newer than configure... done
configure: creating ./config.status
config.status: creating snort.pc
config.status: creating Makefile
config.status: creating src/Makefile
config.status: creating src/sfutil/Makefile
config.status: creating src/control/Makefile
config.status: creating src/file-process/Makefile
  ...
config.status: creating tools/file_server/Makefile
config.status: creating src/win32/Makefile
config.status: creating src/reload-adjust/Makefile
config.status: creating config.h
config.status: executing depfiles commands
config.status: executing libtool commands
configure: WARNING: unrecognized options: --with-mysql, --enable-dynamicplugin
```

* Tikrinu dvi minimas opcijas:
+
```
osboxes@ldvm1:/usr/local/src/snort-2.9.18$ ./configure --help | grep -i mysql
osboxes@ldvm1:/usr/local/src/snort-2.9.18$ ./configure --help | grep -i plugin
osboxes@ldvm1:/usr/local/src/snort-2.9.18$ ./configure --help | grep -i dynam
  --enable-so-with-static-lib  Enable linking of dynamically loaded preprocessors with a static preprocessor library
  --enable-build-dynamic-examples   Enable building of example dynamically loaded preprocessor and rule (off by default)
  --disable-dlclose        Only use if you are developing dynamic preprocessors or shared object rules.  Disable (--disable-dlclose) for testing valgrind leaks in dynamic libraries so a usable backtrace is reported.  Enabled by default.
```

* Turbūt pernelyg pasikeitė kodas versijoje 2.9.18.  Mėginu jų nebenaudoti.

Konfigūruoju kompiliatorių:

```
osboxes@ldvm1:/usr/local/src/snort-2.9.18$ ./configure --disable-open-appid
checking for a BSD-compatible install... /usr/bin/install -c
checking whether build environment is sane... yes
checking for a thread-safe mkdir -p... /usr/bin/mkdir -p
checking for gawk... no
checking for mawk... mawk
  ...
checking for yylex_destroy support... yes
checking for SFLINUX... no
checking for WRLINUX... no
checking that generated files are newer than configure... done
configure: creating ./config.status
config.status: creating snort.pc
config.status: creating Makefile
config.status: creating src/Makefile
config.status: creating src/sfutil/Makefile
config.status: creating src/control/Makefile
  ...
config.status: creating src/reload-adjust/Makefile
config.status: creating config.h
config.status: config.h is unchanged
config.status: executing depfiles commands
config.status: executing libtool commands
```

Sukompiliuoju Snort:

```
osboxes@ldvm1:/usr/local/src/snort-2.9.18$ time make
make  all-recursive
make[1]: Entering directory '/usr/local/src/snort-2.9.18'
Making all in src
make[2]: Entering directory '/usr/local/src/snort-2.9.18/src'
Making all in sfutil
make[3]: Entering directory '/usr/local/src/snort-2.9.18/src/sfutil'
gcc -DHAVE_CONFIG_H -I. -I../.. -I../.. -I../../src -I../../src/sfutil -I/usr/include/pcap -I../../src/output-plugins -I../../src/detection-plugins -I../../src/dynamic-plugins -I../../src/preprocessors -I../../src/preprocessors/portscan -I../../src/preprocessors/HttpInspect/include -I../../src/preprocessors/Session -I../../src/preprocessors/Stream6 -I../../src/target-based -I../../src/control -I../../src/file-process -I../../src/file-process/libs -I../../src/side-channel -I../../src/side-channel/plugins -I../../src/reload-adjust  -DGRE -DMPLS -DPPM_MGR -DNDEBUG -DENABLE_REACT -DENABLE_RESPOND -DENABLE_RESPONSE3 -DSF_WCHAR -DTARGET_BASED -DPERF_PROFILING -DSNORT_RELOAD -DNO_NON_ETHER_DECODER -DNORMALIZER -DACTIVE_RESPONSE  -g -O2 -DSF_VISIBILITY -fvisibility=hidden -Wall -c sfghash.c
  ...
make[3]: Leaving directory '/usr/local/src/snort-2.9.18/tools/u2boat'
Making all in u2spewfoo
make[3]: Entering directory '/usr/local/src/snort-2.9.18/tools/u2spewfoo'
gcc -DHAVE_CONFIG_H -I. -I../.. -I../.. -I../../src -I../../src/sfutil -I/usr/include/pcap -I../../src/output-plugins -I../../src/detection-plugins -I../../src/dynamic-plugins -I../../src/preprocessors -I../../src/preprocessors/portscan -I../../src/preprocessors/HttpInspect/include -I../../src/preprocessors/Session -I../../src/preprocessors/Stream6 -I../../src/target-based -I../../src/control -I../../src/file-process -I../../src/file-process/libs -I../../src/side-channel -I../../src/side-channel/plugins -I../../src/reload-adjust -I/usr/include/pcap  -DGRE -DMPLS -DPPM_MGR -DNDEBUG -DENABLE_REACT -DENABLE_RESPOND -DENABLE_RESPONSE3 -DSF_WCHAR -DTARGET_BASED -DPERF_PROFILING -DSNORT_RELOAD -DNO_NON_ETHER_DECODER -DNORMALIZER -DACTIVE_RESPONSE -g -O2 -DSF_VISIBILITY -fvisibility=hidden -Wall  -g -O2 -DSF_VISIBILITY -fvisibility=hidden -Wall -MT u2spewfoo-u2spewfoo.o -MD -MP -MF .deps/u2spewfoo-u2spewfoo.Tpo -c -o u2spewfoo-u2spewfoo.o `test -f 'u2spewfoo.c' || echo './'`u2spewfoo.c
mv -f .deps/u2spewfoo-u2spewfoo.Tpo .deps/u2spewfoo-u2spewfoo.Po
/bin/bash ../../libtool  --tag=CC   --mode=link gcc -g -O2 -DSF_VISIBILITY -fvisibility=hidden -Wall  -g -O2 -DSF_VISIBILITY -fvisibility=hidden -Wall  -lpcre -ldumbnet -o u2spewfoo u2spewfoo-u2spewfoo.o  -lz -ldaq_static -ldumbnet -lpcre -lpcap -lnsl -lm -lm  -lcrypto -ldl -L/usr/lib -ldaq_static_modules  -lsfbpf -lpcap -lsfbpf -lpcap -lz -lpthread -lpthread -lpthread
libtool: link: gcc -g -O2 -DSF_VISIBILITY -fvisibility=hidden -Wall -g -O2 -DSF_VISIBILITY -fvisibility=hidden -Wall -o u2spewfoo u2spewfoo-u2spewfoo.o  -ldaq_static /usr/lib/x86_64-linux-gnu/libdumbnet.so -lpcre -lnsl -lm -lcrypto -ldl -L/usr/lib -ldaq_static_modules -lsfbpf -lpcap -lz -lpthread
make[3]: Leaving directory '/usr/local/src/snort-2.9.18/tools/u2spewfoo'
make[3]: Entering directory '/usr/local/src/snort-2.9.18/tools'
make[3]: Nothing to be done for 'all-am'.
make[3]: Leaving directory '/usr/local/src/snort-2.9.18/tools'
make[2]: Leaving directory '/usr/local/src/snort-2.9.18/tools'
make[2]: Entering directory '/usr/local/src/snort-2.9.18'
make[2]: Leaving directory '/usr/local/src/snort-2.9.18'
make[1]: Leaving directory '/usr/local/src/snort-2.9.18'

real    3m11.636s
user    2m30.736s
sys     0m27.825s
```

Ir suinstaliuoju:

```
osboxes@ldvm1:/usr/local/src/snort-2.9.18$ sudo make install
Making install in src
make[1]: Entering directory '/usr/local/src/snort-2.9.18/src'
Making install in sfutil
make[2]: Entering directory '/usr/local/src/snort-2.9.18/src/sfutil'
make[3]: Entering directory '/usr/local/src/snort-2.9.18/src/sfutil'
make[3]: Nothing to be done for 'install-exec-am'.
make[3]: Nothing to be done for 'install-data-am'.
make[3]: Leaving directory '/usr/local/src/snort-2.9.18/src/sfutil'
make[2]: Leaving directory '/usr/local/src/snort-2.9.18/src/sfutil'
  ...
make[2]: Entering directory '/usr/local/src/snort-2.9.18'
make[2]: Nothing to be done for 'install-exec-am'.
 /usr/bin/mkdir -p '/usr/local/share/man/man8'
 /usr/bin/install -c -m 644 snort.8 '/usr/local/share/man/man8'
 /usr/bin/mkdir -p '/usr/local/lib/pkgconfig'
 /usr/bin/install -c -m 644 snort.pc '/usr/local/lib/pkgconfig'
make[2]: Leaving directory '/usr/local/src/snort-2.9.18'
make[1]: Leaving directory '/usr/local/src/snort-2.9.18'
```

#### 3. Konfigūracijos ir žurnalo direktorijos

Sukuriu direktorijas:

```
osboxes@ldvm1:/usr/local/src/snort-2.9.18$ sudo mkdir /etc/snort
osboxes@ldvm1:/usr/local/src/snort-2.9.18$ sudo mkdir /var/log/snort
```

Pridedu grupę ir vartotoją:

```
osboxes@ldvm1:/usr/local/src/snort-2.9.18$ sudo groupadd snort
osboxes@ldvm1:/usr/local/src/snort-2.9.18$ sudo useradd -g snort snort
```

Pakeičiu logų direktorijos teises:

```
osboxes@ldvm1:/usr/local/src/snort-2.9.18$ sudo chown snort:snort /var/log/snort
```

Nukopijuoju standartinius konfigūracinius failus:

```
osboxes@ldvm1:/usr/local/src/snort-2.9.18$ sudo cp -v /usr/local/src/snort-2.9.18/etc/*.* /etc/snort/
'/usr/local/src/snort-2.9.18/etc/attribute_table.dtd' -> '/etc/snort/attribute_table.dtd'
'/usr/local/src/snort-2.9.18/etc/classification.config' -> '/etc/snort/classification.config'
'/usr/local/src/snort-2.9.18/etc/file_magic.conf' -> '/etc/snort/file_magic.conf'
'/usr/local/src/snort-2.9.18/etc/gen-msg.map' -> '/etc/snort/gen-msg.map'
'/usr/local/src/snort-2.9.18/etc/Makefile.am' -> '/etc/snort/Makefile.am'
'/usr/local/src/snort-2.9.18/etc/Makefile.in' -> '/etc/snort/Makefile.in'
'/usr/local/src/snort-2.9.18/etc/reference.config' -> '/etc/snort/reference.config'
'/usr/local/src/snort-2.9.18/etc/snort.conf' -> '/etc/snort/snort.conf'
'/usr/local/src/snort-2.9.18/etc/threshold.conf' -> '/etc/snort/threshold.conf'
'/usr/local/src/snort-2.9.18/etc/unicode.map' -> '/etc/snort/unicode.map'

osboxes@ldvm1:/usr/local/src/snort-2.9.18$ sudo chown snort:snort /etc/snort/
```

#### 4. Pradinis stebėjimas

Stebiu tinklo srautą, įrašau duomenis į failus:

```
osboxes@ldvm1:/usr/local/src/snort-2.9.18$ sudo -i
root@ldvm1:~# snort -v > snort1
Running in packet dump mode

        --== Initializing Snort ==--
Initializing Output Plugins!
pcap DAQ configured to passive.
Acquiring network traffic from "enp0s3".
Decoding Ethernet

        --== Initialization Complete ==--

   ,,_     -*> Snort! <*-
  o"  )~   Version 2.9.18 GRE (Build 169) 
   ''''    By Martin Roesch & The Snort Team: http://www.snort.org/contact#team
           Copyright (C) 2014-2021 Cisco and/or its affiliates. All rights reserved.
           Copyright (C) 1998-2013 Sourcefire, Inc., et al.
           Using libpcap version 1.9.1 (with TPACKET_V3)
           Using PCRE version: 8.39 2016-06-14
           Using ZLIB version: 1.2.11

Commencing packet processing (pid=49740)
```

* Ir susiduriu kliūtim: Snort naudoja ne mano sukonfigūruotąją tinklo sąsają `enp0s8`.  +
  Panašu, kad naudoja pirmą sąsją iš eilės, `enp0s3`, per kurią nėra jokio srauto.

* Iškart kita kliūtis – Snort nereaguoja į `Ctrl-C` paspaudimus ir tęsią veikimą:

```
^C
^C^C
```
* Tuomet procesą tik pristabdau paspausdamas `Ctrl-Z` ir terminuoju su komanda `pkill`:

```
^Z
[1]+  Stopped                 snort -v > snort1
root@ldvm1:~# 
root@ldvm1:~# pkill -9 snort
root@ldvm1:~# 
[1]+  Killed                  snort -v > snort1
```

* Panašu į Snort bugą, kad kol nepagavo nei vieno paketo, programa ignoruoja `Ctrl-C` paspaudimus.

* Paskaitinėju `man snort` ir pakeičiu stebimą tinklo sąsają:

```
root@ldvm1:~# snort -v -i enp0s8 > snort1
Running in packet dump mode

        --== Initializing Snort ==--
Initializing Output Plugins!
pcap DAQ configured to passive.
Acquiring network traffic from "enp0s8".
Decoding Ethernet

        --== Initialization Complete ==--

   ,,_     -*> Snort! <*-
  o"  )~   Version 2.9.18 GRE (Build 169) 
   ''''    By Martin Roesch & The Snort Team: http://www.snort.org/contact#team
           Copyright (C) 2014-2021 Cisco and/or its affiliates. All rights reserved.
           Copyright (C) 1998-2013 Sourcefire, Inc., et al.
           Using libpcap version 1.9.1 (with TPACKET_V3)
           Using PCRE version: 8.39 2016-06-14
           Using ZLIB version: 1.2.11

Commencing packet processing (pid=51648)
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
^C*** Caught Int-Signal
===============================================================================
Run time for packet processing was 8.187221 seconds
Snort processed 23 packets.
Snort ran for 0 days 0 hours 0 minutes 8 seconds
   Pkts/sec:            2
===============================================================================
Memory usage summary:
  Total non-mmapped bytes (arena):       786432
  Bytes in mapped regions (hblkhd):      22941696
  Total allocated space (uordblks):      688640
  Total free space (fordblks):           97792
  Topmost releasable block (keepcost):   95696
===============================================================================
Packet I/O Totals:
   Received:           28
   Analyzed:           23 ( 82.143%)
    Dropped:            0 (  0.000%)
   Filtered:            0 (  0.000%)
Outstanding:            5 ( 17.857%)
   Injected:            0
===============================================================================
Breakdown by protocol (includes rebuilt packets):
        Eth:           23 (100.000%)
       VLAN:            0 (  0.000%)
        IP4:           23 (100.000%)
       Frag:            0 (  0.000%)
       ICMP:            0 (  0.000%)
        UDP:            0 (  0.000%)
        TCP:           23 (100.000%)
        IP6:            0 (  0.000%)
    IP6 Ext:            0 (  0.000%)
   IP6 Opts:            0 (  0.000%)
      Frag6:            0 (  0.000%)
      ICMP6:            0 (  0.000%)
       UDP6:            0 (  0.000%)
       TCP6:            0 (  0.000%)
     Teredo:            0 (  0.000%)
    ICMP-IP:            0 (  0.000%)
    IP4/IP4:            0 (  0.000%)
    IP4/IP6:            0 (  0.000%)
    IP6/IP4:            0 (  0.000%)
    IP6/IP6:            0 (  0.000%)
        GRE:            0 (  0.000%)
    GRE Eth:            0 (  0.000%)
   GRE VLAN:            0 (  0.000%)
    GRE IP4:            0 (  0.000%)
    GRE IP6:            0 (  0.000%)
GRE IP6 Ext:            0 (  0.000%)
   GRE PPTP:            0 (  0.000%)
    GRE ARP:            0 (  0.000%)
    GRE IPX:            0 (  0.000%)
   GRE Loop:            0 (  0.000%)
       MPLS:            0 (  0.000%)
        ARP:            0 (  0.000%)
        IPX:            0 (  0.000%)
   Eth Loop:            0 (  0.000%)
   Eth Disc:            0 (  0.000%)
   IP4 Disc:            0 (  0.000%)
   IP6 Disc:            0 (  0.000%)
   TCP Disc:            0 (  0.000%)
   UDP Disc:            0 (  0.000%)
  ICMP Disc:            0 (  0.000%)
All Discard:            0 (  0.000%)
      Other:            0 (  0.000%)
Bad Chk Sum:           12 ( 52.174%)
    Bad TTL:            0 (  0.000%)
     S5 G 1:            0 (  0.000%)
     S5 G 2:            0 (  0.000%)
      Total:           23
===============================================================================

Memory Statistics for File at:Wed Jul  7 07:52:55 2021

Total buffers allocated:           0          
Total buffers freed:               0          
Total buffers released:            0          
Total file mempool:                0          
Total allocated file mempool:      0          
Total freed file mempool:          0          
Total released file mempool:       0          

Heap Statistics of file:
          Total Statistics:
               Memory in use:              0 bytes
                No of allocs:              0
                 No of frees:              0
===============================================================================
Snort exiting
```

* Sunkumas išspręstas nurodžius aktyvią tinklo sąsają.

Analizuoju stebėjimo failus:

```
root@ldvm1:~# file snort1
snort1: ASCII text
root@ldvm1:~# cat snort1 | wc -l
138
root@ldvm1:~# less snort1
root@ldvm1:~# cat snort1 | grep -c -- '->'
23
root@ldvm1:~# cat snort1 | grep -- '->'
07/07-07:52:46.822122 192.168.10.14:22 -> 192.168.10.254:40548
07/07-07:52:46.822276 192.168.10.14:22 -> 192.168.10.254:40548
07/07-07:52:46.822451 192.168.10.254:40548 -> 192.168.10.14:22
07/07-07:52:46.822453 192.168.10.254:40548 -> 192.168.10.14:22
07/07-07:52:46.822564 192.168.10.14:22 -> 192.168.10.254:40548
07/07-07:52:46.822686 192.168.10.254:40548 -> 192.168.10.14:22
07/07-07:52:46.822836 192.168.10.14:22 -> 192.168.10.254:40548
07/07-07:52:46.823256 192.168.10.254:40548 -> 192.168.10.14:22
07/07-07:52:47.802795 192.168.10.14:22 -> 192.168.10.254:40548
07/07-07:52:47.803265 192.168.10.254:40548 -> 192.168.10.14:22
07/07-07:52:47.803299 192.168.10.14:22 -> 192.168.10.254:40548
07/07-07:52:47.803619 192.168.10.254:40548 -> 192.168.10.14:22
07/07-07:52:48.826301 192.168.10.14:22 -> 192.168.10.254:40548
07/07-07:52:48.826924 192.168.10.254:40548 -> 192.168.10.14:22
07/07-07:52:49.850174 192.168.10.14:22 -> 192.168.10.254:40548
07/07-07:52:49.850708 192.168.10.254:40548 -> 192.168.10.14:22
07/07-07:52:50.874372 192.168.10.14:22 -> 192.168.10.254:40548
07/07-07:52:50.875024 192.168.10.254:40548 -> 192.168.10.14:22
07/07-07:52:51.899320 192.168.10.14:22 -> 192.168.10.254:40548
07/07-07:52:51.899778 192.168.10.254:40548 -> 192.168.10.14:22
07/07-07:52:52.922172 192.168.10.14:22 -> 192.168.10.254:40548
07/07-07:52:52.922589 192.168.10.254:40548 -> 192.168.10.14:22
07/07-07:52:53.946166 192.168.10.14:22 -> 192.168.10.254:40548
```

- tai tekstinis failas iš 138 eilučių;
- jame aptinku 23 paketus;
- pagal 22/TCP prievadą panašu, kad registruotas tik mano paties SSH srautas;
- atskiras TCP paketas aprašomas tokiu pavidalu:
+
```
07/07-07:52:46.822453 192.168.10.254:40548 -> 192.168.10.14:22
TCP TTL:64 TOS:0x10 ID:26573 IpLen:20 DgmLen:52 DF
***A**** Seq: 0xCF9BC6E6  Ack: 0x95B0E326  Win: 0x590  TcpLen: 32
TCP Options (3) => NOP NOP TS: 61716058 1184245986 
=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+
```

#### 5. Paketų rinkimo režimas

Startuoju paketų rinkimo režimu:

```
root@ldvm1:~# snort -dev -l -i enp0s8 /var/log/snort
Running in packet logging mode

        --== Initializing Snort ==--
Initializing Output Plugins!
Snort BPF option: enp0s8 /var/log/snort
ERROR: Stat check on log dir failed: No such file or directory.
Fatal Error, Quitting..
root@ldvm1:~# snort -i enp0s8 -dev -l /var/log/snort
Running in packet logging mode

        --== Initializing Snort ==--
Initializing Output Plugins!
Log directory = /var/log/snort
pcap DAQ configured to passive.
Acquiring network traffic from "enp0s8".
Decoding Ethernet

        --== Initialization Complete ==--

   ,,_     -*> Snort! <*-
  o"  )~   Version 2.9.18 GRE (Build 169) 
   ''''    By Martin Roesch & The Snort Team: http://www.snort.org/contact#team
           Copyright (C) 2014-2021 Cisco and/or its affiliates. All rights reserved.
           Copyright (C) 1998-2013 Sourcefire, Inc., et al.
           Using libpcap version 1.9.1 (with TPACKET_V3)
           Using PCRE version: 8.39 2016-06-14
           Using ZLIB version: 1.2.11

Commencing packet processing (pid=51843)
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
WARNING: No preprocessors configured for policy 0.
```

Siunčiu užklausas iš fizinio kompiuterio:

```
[p@localhost Saulius-Krasuckas]$ ping 192.168.10.14
PING 192.168.10.14 (192.168.10.14) 56(84) bytes of data.
64 bytes from 192.168.10.14: icmp_seq=1 ttl=64 time=0.651 ms
64 bytes from 192.168.10.14: icmp_seq=2 ttl=64 time=0.647 ms
^C
--- 192.168.10.14 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1000ms
rtt min/avg/max/mdev = 0.647/0.649/0.651/0.002 ms
```

Sustabdau paketų rinkimą:

```
^C*** Caught Int-Signal
===============================================================================
Run time for packet processing was 36.425998 seconds
Snort processed 77 packets.
Snort ran for 0 days 0 hours 0 minutes 36 seconds
   Pkts/sec:            2
===============================================================================
Memory usage summary:
  Total non-mmapped bytes (arena):       786432
  Bytes in mapped regions (hblkhd):      22941696
  Total allocated space (uordblks):      685984
  Total free space (fordblks):           100448
  Topmost releasable block (keepcost):   93552
===============================================================================
Packet I/O Totals:
   Received:           81
   Analyzed:           77 ( 95.062%)
    Dropped:            0 (  0.000%)
   Filtered:            0 (  0.000%)
Outstanding:            4 (  4.938%)
   Injected:            0
===============================================================================
Breakdown by protocol (includes rebuilt packets):
        Eth:           77 (100.000%)
       VLAN:            0 (  0.000%)
        IP4:           77 (100.000%)
       Frag:            0 (  0.000%)
       ICMP:            4 (  5.195%)
        UDP:            2 (  2.597%)
        TCP:           71 ( 92.208%)
        IP6:            0 (  0.000%)
    IP6 Ext:            0 (  0.000%)
   IP6 Opts:            0 (  0.000%)
      Frag6:            0 (  0.000%)
      ICMP6:            0 (  0.000%)
       UDP6:            0 (  0.000%)
       TCP6:            0 (  0.000%)
     Teredo:            0 (  0.000%)
    ICMP-IP:            0 (  0.000%)
    IP4/IP4:            0 (  0.000%)
    IP4/IP6:            0 (  0.000%)
    IP6/IP4:            0 (  0.000%)
    IP6/IP6:            0 (  0.000%)
        GRE:            0 (  0.000%)
    GRE Eth:            0 (  0.000%)
   GRE VLAN:            0 (  0.000%)
    GRE IP4:            0 (  0.000%)
    GRE IP6:            0 (  0.000%)
GRE IP6 Ext:            0 (  0.000%)
   GRE PPTP:            0 (  0.000%)
    GRE ARP:            0 (  0.000%)
    GRE IPX:            0 (  0.000%)
   GRE Loop:            0 (  0.000%)
       MPLS:            0 (  0.000%)
        ARP:            0 (  0.000%)
        IPX:            0 (  0.000%)
   Eth Loop:            0 (  0.000%)
   Eth Disc:            0 (  0.000%)
   IP4 Disc:            0 (  0.000%)
   IP6 Disc:            0 (  0.000%)
   TCP Disc:            0 (  0.000%)
   UDP Disc:            0 (  0.000%)
  ICMP Disc:            0 (  0.000%)
All Discard:            0 (  0.000%)
      Other:            0 (  0.000%)
Bad Chk Sum:           37 ( 48.052%)
    Bad TTL:            0 (  0.000%)
     S5 G 1:            0 (  0.000%)
     S5 G 2:            0 (  0.000%)
      Total:           77
===============================================================================

Memory Statistics for File at:Wed Jul  7 08:29:37 2021

Total buffers allocated:           0          
Total buffers freed:               0          
Total buffers released:            0          
Total file mempool:                0          
Total allocated file mempool:      0          
Total freed file mempool:          0          
Total released file mempool:       0          

Heap Statistics of file:
          Total Statistics:
               Memory in use:              0 bytes
                No of allocs:              0
                 No of frees:              0
===============================================================================
Snort exiting
root@ldvm1:~# 
```

Nuskaitau informaciją apie sustebėtus ICMP paketus:

```
root@ldvm1:~# snort -dvr /var/log/snort/snort.log.1625635740 icmp
Running in packet dump mode

        --== Initializing Snort ==--
Initializing Output Plugins!
Snort BPF option: icmp
pcap DAQ configured to read-file.
Acquiring network traffic from "/var/log/snort/snort.log.1625635740".

        --== Initialization Complete ==--

   ,,_     -*> Snort! <*-
  o"  )~   Version 2.9.18 GRE (Build 169) 
   ''''    By Martin Roesch & The Snort Team: http://www.snort.org/contact#team
           Copyright (C) 2014-2021 Cisco and/or its affiliates. All rights reserved.
           Copyright (C) 1998-2013 Sourcefire, Inc., et al.
           Using libpcap version 1.9.1 (with TPACKET_V3)
           Using PCRE version: 8.39 2016-06-14
           Using ZLIB version: 1.2.11

Commencing packet processing (pid=51944)
WARNING: No preprocessors configured for policy 0.
07/07-08:29:18.674234 192.168.10.254 -> 192.168.10.14
ICMP TTL:64 TOS:0x0 ID:25922 IpLen:20 DgmLen:84 DF
Type:8  Code:0  ID:16476   Seq:1  ECHO
AE 3B E5 60 00 00 00 00 D9 01 0D 00 00 00 00 00  .;.`............
10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F  ................
20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F   !"#$%&'()*+,-./
30 31 32 33 34 35 36 37                          01234567

=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

WARNING: No preprocessors configured for policy 0.
07/07-08:29:18.674311 192.168.10.14 -> 192.168.10.254
ICMP TTL:64 TOS:0x0 ID:59141 IpLen:20 DgmLen:84
Type:0  Code:0  ID:16476  Seq:1  ECHO REPLY
AE 3B E5 60 00 00 00 00 D9 01 0D 00 00 00 00 00  .;.`............
10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F  ................
20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F   !"#$%&'()*+,-./
30 31 32 33 34 35 36 37                          01234567

=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

WARNING: No preprocessors configured for policy 0.
07/07-08:29:19.657679 192.168.10.254 -> 192.168.10.14
ICMP TTL:64 TOS:0x0 ID:26495 IpLen:20 DgmLen:84 DF
Type:8  Code:0  ID:16476   Seq:2  ECHO
AF 3B E5 60 00 00 00 00 2F 04 0D 00 00 00 00 00  .;.`..../.......
10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F  ................
20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F   !"#$%&'()*+,-./
30 31 32 33 34 35 36 37                          01234567

=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

WARNING: No preprocessors configured for policy 0.
07/07-08:29:19.657727 192.168.10.14 -> 192.168.10.254
ICMP TTL:64 TOS:0x0 ID:59190 IpLen:20 DgmLen:84
Type:0  Code:0  ID:16476  Seq:2  ECHO REPLY
AF 3B E5 60 00 00 00 00 2F 04 0D 00 00 00 00 00  .;.`..../.......
10 11 12 13 14 15 16 17 18 19 1A 1B 1C 1D 1E 1F  ................
20 21 22 23 24 25 26 27 28 29 2A 2B 2C 2D 2E 2F   !"#$%&'()*+,-./
30 31 32 33 34 35 36 37                          01234567

=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+

===============================================================================
Run time for packet processing was 0.244 seconds
Snort processed 4 packets.
Snort ran for 0 days 0 hours 0 minutes 0 seconds
   Pkts/sec:            4
===============================================================================
Memory usage summary:
  Total non-mmapped bytes (arena):       786432
  Bytes in mapped regions (hblkhd):      23216128
  Total allocated space (uordblks):      685584
  Total free space (fordblks):           100848
  Topmost releasable block (keepcost):   93024
===============================================================================
Packet I/O Totals:
   Received:            4
   Analyzed:            4 (100.000%)
    Dropped:            0 (  0.000%)
   Filtered:            0 (  0.000%)
Outstanding:            0 (  0.000%)
   Injected:            0
===============================================================================
Breakdown by protocol (includes rebuilt packets):
        Eth:            4 (100.000%)
       VLAN:            0 (  0.000%)
        IP4:            4 (100.000%)
       Frag:            0 (  0.000%)
       ICMP:            4 (100.000%)
        UDP:            0 (  0.000%)
        TCP:            0 (  0.000%)
        IP6:            0 (  0.000%)
    IP6 Ext:            0 (  0.000%)
   IP6 Opts:            0 (  0.000%)
      Frag6:            0 (  0.000%)
      ICMP6:            0 (  0.000%)
       UDP6:            0 (  0.000%)
       TCP6:            0 (  0.000%)
     Teredo:            0 (  0.000%)
    ICMP-IP:            0 (  0.000%)
    IP4/IP4:            0 (  0.000%)
    IP4/IP6:            0 (  0.000%)
    IP6/IP4:            0 (  0.000%)
    IP6/IP6:            0 (  0.000%)
        GRE:            0 (  0.000%)
    GRE Eth:            0 (  0.000%)
   GRE VLAN:            0 (  0.000%)
    GRE IP4:            0 (  0.000%)
    GRE IP6:            0 (  0.000%)
GRE IP6 Ext:            0 (  0.000%)
   GRE PPTP:            0 (  0.000%)
    GRE ARP:            0 (  0.000%)
    GRE IPX:            0 (  0.000%)
   GRE Loop:            0 (  0.000%)
       MPLS:            0 (  0.000%)
        ARP:            0 (  0.000%)
        IPX:            0 (  0.000%)
   Eth Loop:            0 (  0.000%)
   Eth Disc:            0 (  0.000%)
   IP4 Disc:            0 (  0.000%)
   IP6 Disc:            0 (  0.000%)
   TCP Disc:            0 (  0.000%)
   UDP Disc:            0 (  0.000%)
  ICMP Disc:            0 (  0.000%)
All Discard:            0 (  0.000%)
      Other:            0 (  0.000%)
Bad Chk Sum:            0 (  0.000%)
    Bad TTL:            0 (  0.000%)
     S5 G 1:            0 (  0.000%)
     S5 G 2:            0 (  0.000%)
      Total:            4
===============================================================================

Memory Statistics for File at:Wed Jul  7 08:35:20 2021

Total buffers allocated:           0          
Total buffers freed:               0          
Total buffers released:            0          
Total file mempool:                0          
Total allocated file mempool:      0          
Total freed file mempool:          0          
Total released file mempool:       0          

Heap Statistics of file:
          Total Statistics:
               Memory in use:              0 bytes
                No of allocs:              0
                 No of frees:              0
===============================================================================
Snort exiting
```

Išsiųstos buvo dvi ICMP užklausos, iš viso surinkti keturi ICMP paketai.


#### 6. Snort konfigūravimas

Susipažįstu su konfigūracijos failo struktūra:

```
root@ldvm1:~# wc -l /etc/snort/snort.conf
689 /etc/snort/snort.conf

root@ldvm1:~# nano /etc/snort/snort.conf

Use "fg" to return to nano.

[1]+  Stopped                 nano /etc/snort/snort.conf
```

Atkreipiu dėmesį:

- į globalius kintamuosius:
+
```
###################################################
# Step #1: Set the network variables.  For more information, see README.variables
###################################################

# Setup the network addresses you are protecting
ipvar HOME_NET any

# Set up the external network addresses. Leave as "any" in most situations
ipvar EXTERNAL_NET any

# List of DNS servers on your network 
ipvar DNS_SERVERS $HOME_NET
```

- naudojamus preprocesorius:
+
```
###################################################
# Step #5: Configure preprocessors
# For more information, see the Snort Manual, Configuring Snort - Preprocessors
###################################################

# GTP Control Channle Preprocessor. For more information, see README.GTP
# preprocessor gtp: ports { 2123 3386 2152 }

# Inline packet normalization. For more information, see README.normalize
# Does nothing in IDS mode
preprocessor normalize_ip4
preprocessor normalize_tcp: ips ecn stream
preprocessor normalize_icmp4
```

- į išvedimo įskiepius:
+
```
###################################################
# Step #6: Configure output plugins
# For more information, see Snort Manual, Configuring Snort - Output Modules
###################################################

# unified2 
# Recommended for most installs
# output unified2: filename merged.log, limit 128, nostamp, mpls_event_types, vlan_event_types
  ...
# pcap
# output log_tcpdump: tcpdump.log

# metadata reference data.  do not modify these lines
include classification.config
include reference.config
```

- ir į naudojamas taisykles:
+
```
###################################################
# Step #7: Customize your rule set
# For more information, see Snort Manual, Writing Snort Rules
#
# NOTE: All categories are enabled in this conf file
###################################################

# site specific rules
include $RULE_PATH/local.rules

include $RULE_PATH/app-detect.rules
include $RULE_PATH/attack-responses.rules
  ...
include $RULE_PATH/web-misc.rules
include $RULE_PATH/web-php.rules
include $RULE_PATH/x11.rules
```

Redaguoju failą ir jame įrašau parametrus:

```
[1]+  Stopped                 nano /etc/snort/snort.conf
root@ldvm1:~# cat /etc/snort/snort.conf | awk '/var (RULE_PATH|HOME_NET|EXTERNAL_NET)/'
ipvar HOME_NET 192.168.10.0/24
ipvar EXTERNAL_NET !$HOME_INET
var RULE_PATH /etc/snort/rules
root@ldvm1:~# 
```

Naudoju simbolį `#` ir užkomentuoju visas taisykles, išskyrus `local.rules`:

```
root@ldvm1:~# cat /etc/snort/snort.conf | grep '^include .RULE'
include $RULE_PATH/local.rules

root@ldvm1:~# cat /etc/snort/snort.conf | grep -c '^#include .RULE'
104
```

- Iš viso užkomentavau 104 taisykles – daug.

Tikrinu, ar užkomentuotas išvedimas į DB:

```
root@ldvm1:~# cat /etc/snort/snort.conf | grep -n database

root@ldvm1:~# cat /etc/snort/snort.conf | grep -n output
34:#  6) Configure output plugins
515:# Step #6: Configure output plugins
521:# output unified2: filename merged.log, limit 128, nostamp, mpls_event_types, vlan_event_types
524:# output alert_unified2: filename snort.alert, limit 128, nostamp
525:# output log_unified2: filename snort.log, limit 128, nostamp 
528:# output alert_syslog: LOG_AUTH LOG_ALERT
531:# output log_tcpdump: tcpdump.log

root@ldvm1:~# cat /etc/snort/snort.conf | grep -n -w -e log -e mysql
184:# Configure default log directory for snort to log to.  For more information see snort -h command line options (-l)
201:config event_queue: max_queue 8 log 5 order_events content_length
218:#   pkt-log
225:#   rule-log alert
521:# output unified2: filename merged.log, limit 128, nostamp, mpls_event_types, vlan_event_types
525:# output log_unified2: filename snort.log, limit 128, nostamp 
531:# output log_tcpdump: tcpdump.log
591:#include $RULE_PATH/mysql.rules
628:#include $RULE_PATH/server-mysql.rules
```

- Tokios eilutės net nerandu. Laikau, kad užkomentuota.


#### 7. Taisyklių vieta

Sukuriu direktoriją:

```
root@ldvm1:~# mkdir /etc/snort/rules
```

Redaguoju failą `local.rules`:

```
root@ldvm1:~# nano /etc/snort/rules/local.rules


Use "fg" to return to nano.

[2]+  Stopped                 nano /etc/snort/rules/local.rules
```

Parašau paprastą taisyklę, kuri praneša apie ICMP paketus, ir failą išsaugau:

```
root@ldvm1:~# cat /etc/snort/rules/local.rules
alert icmp any any -> 192.168.10.14 any (msg: "ICMP test"; sid:10000001;)
root@ldvm1:~# 
```

#### 8. ICMP užklausų atpažinimas

Startuoju Snort paslaugą:

```
root@ldvm1:~# /usr/local/bin/snort -u snort -g snort -c /etc/snort/snort.conf
Running in IDS mode

        --== Initializing Snort ==--
Initializing Output Plugins!
Initializing Preprocessors!
Initializing Plug-ins!
Parsing Rules file "/etc/snort/snort.conf"
ERROR: /etc/snort/snort.conf(48) Failed to parse the IP address: !$HOME_INET.
Fatal Error, Quitting..
```

* Gaunu klaidą.  Matau perteklinę raidę kintamojo `HOME_INET` varde.
* Pataisau `snort.conf` ir startuoju paslaugą iš naujo.
+
```
root@ldvm1:~# fg 1
nano /etc/snort/snort.conf


Use "fg" to return to nano.

[1]+  Stopped                 nano /etc/snort/snort.conf

root@ldvm1:~# /usr/local/bin/snort -u snort -g snort -c /etc/snort/snort.conf
Running in IDS mode

        --== Initializing Snort ==--
Initializing Output Plugins!
Initializing Preprocessors!
Initializing Plug-ins!
Parsing Rules file "/etc/snort/snort.conf"
PortVar 'HTTP_PORTS' defined :  [ 80:81 311 383 591 593 901 1220 1414 1741 1830 2301 2381 2809 3037 3128 3702 4343 4848 5250 6988 7000:7001 7144:7145 7510 7777 7779 8000 8008 8014 8028 8080 8085 8088 8090 8118 8123 8180:8181 8243 8280 8300 8800 8888 8899 9000 9060 9080 9090:9091 9443 9999 11371 34443:34444 41080 50002 55555 ]
PortVar 'SHELLCODE_PORTS' defined :  [ 0:79 81:65535 ]
PortVar 'ORACLE_PORTS' defined :  [ 1024:65535 ]
PortVar 'SSH_PORTS' defined :  [ 22 ]
PortVar 'FTP_PORTS' defined :  [ 21 2100 3535 ]
PortVar 'SIP_PORTS' defined :  [ 5060:5061 5600 ]
PortVar 'FILE_DATA_PORTS' defined :  [ 80:81 110 143 311 383 591 593 901 1220 1414 1741 1830 2301 2381 2809 3037 3128 3702 4343 4848 5250 6988 7000:7001 7144:7145 7510 7777 7779 8000 8008 8014 8028 8080 8085 8088 8090 8118 8123 8180:8181 8243 8280 8300 8800 8888 8899 9000 9060 9080 9090:9091 9443 9999 11371 34443:34444 41080 50002 55555 ]
PortVar 'GTP_PORTS' defined :  [ 2123 2152 3386 ]
Detection:
   Search-Method = AC-Full-Q
    Split Any/Any group = enabled
    Search-Method-Optimizations = enabled
    Maximum pattern length = 20
ERROR: /etc/snort/snort.conf(253) Could not stat dynamic module path "/usr/local/lib/snort_dynamicrules": No such file or directory.

Fatal Error, Quitting..
```

* Tikrinu direktoriją:
+
```
root@ldvm1:~# ll -d /usr/local/lib/snort*
drwxr-xr-x 4 root root 4096 Jul  7 01:03 /usr/local/lib/snort/
drwxr-xr-x 2 root root 4096 Jul  7 01:03 /usr/local/lib/snort_dynamicengine/
drwxr-xr-x 2 root root 4096 Jul  7 01:03 /usr/local/lib/snort_dynamicpreprocessor/
```

* Susirandu dokumentą ir pagal jį sukuriu trūkstamą direktoriją:
https://s3.amazonaws.com/snort-org-site/production/document_files/files/000/000/091/original/snort-centos6x-7x-298x.pdf#page=15[snort-centos6x-7x-298x.pdf]
+
```
root@ldvm1:~# mkdir /usr/local/lib/snort_dynamicrules
root@ldvm1:~# chown -R snort:snort /usr/local/lib/snort_dynamicrules
root@ldvm1:~# chmod -R 700 /usr/local/lib/snort_dynamicrules
root@ldvm1:~# ll -d /usr/local/lib/snort*
drwxr-xr-x 4 root  root  4096 Jul  7 01:03 /usr/local/lib/snort/
drwxr-xr-x 2 root  root  4096 Jul  7 01:03 /usr/local/lib/snort_dynamicengine/
drwxr-xr-x 2 root  root  4096 Jul  7 01:03 /usr/local/lib/snort_dynamicpreprocessor/
drwx------ 2 snort snort 4096 Jul  7 09:37 /usr/local/lib/snort_dynamicrules/
```

* Startuoju paslaugą iš naujo:
+
```
root@ldvm1:~# /usr/local/bin/snort -u snort -g snort -c /etc/snort/snort.conf 
Running in IDS mode

        --== Initializing Snort ==--
Initializing Output Plugins!
Initializing Preprocessors!
Initializing Plug-ins!
Parsing Rules file "/etc/snort/snort.conf"
PortVar 'HTTP_PORTS' defined :  [ 80:81 311 383 591 593 901 1220 1414 1741 1830 2301 2381 2809 3037 3128 3702 4343 4848 5250 6988 7000:7001 7144:7145 7510 7777 7779 8000 8008 8014 8028 8080 8085 8088 8090 8118 8123 8180:8181 8243 8280 8300 8800 8888 8899 9000 9060 9080 9090:9091 9443 9999 11371 34443:34444 41080 50002 55555 ]
PortVar 'SHELLCODE_PORTS' defined :  [ 0:79 81:65535 ]
PortVar 'ORACLE_PORTS' defined :  [ 1024:65535 ]
PortVar 'SSH_PORTS' defined :  [ 22 ]
PortVar 'FTP_PORTS' defined :  [ 21 2100 3535 ]
PortVar 'SIP_PORTS' defined :  [ 5060:5061 5600 ]
PortVar 'FILE_DATA_PORTS' defined :  [ 80:81 110 143 311 383 591 593 901 1220 1414 1741 1830 2301 2381 2809 3037 3128 3702 4343 4848 5250 6988 7000:7001 7144:7145 7510 7777 7779 8000 8008 8014 8028 8080 8085 8088 8090 8118 8123 8180:8181 8243 8280 8300 8800 8888 8899 9000 9060 9080 9090:9091 9443 9999 11371 34443:34444 41080 50002 55555 ]
PortVar 'GTP_PORTS' defined :  [ 2123 2152 3386 ]
Detection:
   Search-Method = AC-Full-Q
    Split Any/Any group = enabled
    Search-Method-Optimizations = enabled
    Maximum pattern length = 20
Tagged Packet Limit: 256
Loading dynamic engine /usr/local/lib/snort_dynamicengine/libsf_engine.so... done
Loading all dynamic detection libs from /usr/local/lib/snort_dynamicrules...
WARNING: No dynamic libraries found in directory /usr/local/lib/snort_dynamicrules.
  Finished Loading all dynamic detection libs from /usr/local/lib/snort_dynamicrules
Loading all dynamic preprocessor libs from /usr/local/lib/snort_dynamicpreprocessor/...
  Loading dynamic preprocessor library /usr/local/lib/snort_dynamicpreprocessor//libsf_dce2_preproc.so... done
  Loading dynamic preprocessor library /usr/local/lib/snort_dynamicpreprocessor//libsf_dns_preproc.so... done
  Loading dynamic preprocessor library /usr/local/lib/snort_dynamicpreprocessor//libsf_reputation_preproc.so... done
  Loading dynamic preprocessor library /usr/local/lib/snort_dynamicpreprocessor//libsf_sip_preproc.so... done
  Loading dynamic preprocessor library /usr/local/lib/snort_dynamicpreprocessor//libsf_ssh_preproc.so... done
  Loading dynamic preprocessor library /usr/local/lib/snort_dynamicpreprocessor//libsf_sdf_preproc.so... done
  Loading dynamic preprocessor library /usr/local/lib/snort_dynamicpreprocessor//libsf_s7commplus_preproc.so... done
  Loading dynamic preprocessor library /usr/local/lib/snort_dynamicpreprocessor//libsf_dnp3_preproc.so... done
  Loading dynamic preprocessor library /usr/local/lib/snort_dynamicpreprocessor//libsf_pop_preproc.so... done
  Loading dynamic preprocessor library /usr/local/lib/snort_dynamicpreprocessor//libsf_imap_preproc.so... done
  Loading dynamic preprocessor library /usr/local/lib/snort_dynamicpreprocessor//libsf_modbus_preproc.so... done
  Loading dynamic preprocessor library /usr/local/lib/snort_dynamicpreprocessor//libsf_gtp_preproc.so... done
  Loading dynamic preprocessor library /usr/local/lib/snort_dynamicpreprocessor//libsf_ftptelnet_preproc.so... done
  Loading dynamic preprocessor library /usr/local/lib/snort_dynamicpreprocessor//libsf_ssl_preproc.so... done
  Loading dynamic preprocessor library /usr/local/lib/snort_dynamicpreprocessor//libsf_smtp_preproc.so... done
  Finished Loading all dynamic preprocessor libs from /usr/local/lib/snort_dynamicpreprocessor/
Log directory = /var/log/snort
WARNING: ip4 normalizations disabled because not inline.
WARNING: tcp normalizations disabled because not inline.
WARNING: icmp4 normalizations disabled because not inline.
WARNING: ip6 normalizations disabled because not inline.
WARNING: icmp6 normalizations disabled because not inline.
Frag3 global config:
    Max frags: 65536
    Fragment memory cap: 4194304 bytes
Frag3 engine config:
    Bound Address: default
    Target-based policy: WINDOWS
    Fragment timeout: 180 seconds
    Fragment min_ttl:   1
    Fragment Anomalies: Alert
    Overlap Limit:     10
    Min fragment Length:     100
      Max Expected Streams: 768
Stream global config:
    Track TCP sessions: ACTIVE
    Max TCP sessions: 262144
    TCP cache pruning timeout: 30 seconds
    TCP cache nominal timeout: 3600 seconds
    Memcap (for reassembly packet storage): 8388608
    Track UDP sessions: ACTIVE
    Max UDP sessions: 131072
    UDP cache pruning timeout: 30 seconds
    UDP cache nominal timeout: 180 seconds
    Track ICMP sessions: INACTIVE
    Track IP sessions: INACTIVE
    Log info if session memory consumption exceeds 1048576
    Send up to 2 active responses
    Wait at least 5 seconds between responses
    Protocol Aware Flushing: ACTIVE
        Maximum Flush Point: 16000
Stream TCP Policy config:
    Bound Address: default
    Reassembly Policy: WINDOWS
    Timeout: 180 seconds
    Limit on TCP Overlaps: 10
    Maximum number of bytes to queue per session: 1048576
    Maximum number of segs to queue per session: 2621
    Options:
        Require 3-Way Handshake: YES
        3-Way Handshake Timeout: 180
        Detect Anomalies: YES
    Reassembly Ports:
      21 client (Footprint) 
      22 client (Footprint) 
      23 client (Footprint) 
      25 client (Footprint) 
      42 client (Footprint) 
      53 client (Footprint) 
      79 client (Footprint) 
      80 client (Footprint) server (Footprint)
      81 client (Footprint) server (Footprint)
      109 client (Footprint) 
      110 client (Footprint) 
      111 client (Footprint) 
      113 client (Footprint) 
      119 client (Footprint) 
      135 client (Footprint) 
      136 client (Footprint) 
      137 client (Footprint) 
      139 client (Footprint) 
      143 client (Footprint) 
      161 client (Footprint) 
      additional ports configured but not printed.
Stream UDP Policy config:
    Timeout: 180 seconds
HttpInspect Config:
    GLOBAL CONFIG
      Detect Proxy Usage:       NO
      IIS Unicode Map Filename: /etc/snort/unicode.map
      IIS Unicode Map Codepage: 1252
      Memcap used for logging URI and Hostname: 150994944
      Max Gzip Memory: 838860
      Max Gzip Sessions: 1807
      Gzip Compress Depth: 65535
      Gzip Decompress Depth: 65535
      Normalize Random Nulls in Text: NO
    DEFAULT SERVER CONFIG:
      Server profile: All
      Ports (PAF): 80 81 311 383 591 593 901 1220 1414 1741 1830 2301 2381 2809 3037 3128 3702 4343 4848 5250 6988 7000 7001 7144 7145 7510 7777 7779 8000 8008 8014 8028 8080 8085 8088 8090 8118 8123 8180 8181 8243 8280 8300 8800 8888 8899 9000 9060 9080 9090 9091 9443 9999 11371 34443 34444 41080 50002 55555 
      Server Flow Depth: 0
      Client Flow Depth: 0
      Max Chunk Length: 500000
      Small Chunk Length Evasion: chunk size <= 10, threshold >= 5 times
      Max Header Field Length: 750
      Max Number Header Fields: 100
      Max Number of WhiteSpaces allowed with header folding: 200
      Inspect Pipeline Requests: YES
      URI Discovery Strict Mode: NO
      Allow Proxy Usage: NO
      Disable Alerting: NO
      Oversize Dir Length: 500
      Only inspect URI: NO
      Normalize HTTP Headers: NO
      Inspect HTTP Cookies: YES
      Inspect HTTP Responses: YES
      Extract Gzip from responses: YES
      Decompress response files:   
      Unlimited decompression of gzip data from responses: YES
      Normalize Javascripts in HTTP Responses: YES
      Max Number of WhiteSpaces allowed with Javascript Obfuscation in HTTP responses: 200
      Normalize HTTP Cookies: NO
      Enable XFF and True Client IP: NO
      Log HTTP URI data: NO
      Log HTTP Hostname data: NO
      Extended ASCII code support in URI: NO
      Ascii: YES alert: NO
      Double Decoding: YES alert: NO
      %U Encoding: YES alert: YES
      Bare Byte: YES alert: NO
      UTF 8: YES alert: NO
      IIS Unicode: YES alert: NO
      Multiple Slash: YES alert: NO
      IIS Backslash: YES alert: NO
      Directory Traversal: YES alert: NO
      Web Root Traversal: YES alert: NO
      Apache WhiteSpace: YES alert: NO
      IIS Delimiter: YES alert: NO
      IIS Unicode Map: GLOBAL IIS UNICODE MAP CONFIG
      Non-RFC Compliant Characters: 0x00 0x01 0x02 0x03 0x04 0x05 0x06 0x07 
      Whitespace Characters: 0x09 0x0b 0x0c 0x0d 
      Legacy mode: NO
rpc_decode arguments:
    Ports to decode RPC on: 111 32770 32771 32772 32773 32774 32775 32776 32777 32778 32779 
    alert_fragments: INACTIVE
    alert_large_fragments: INACTIVE
    alert_incomplete: INACTIVE
    alert_multiple_requests: INACTIVE
FTPTelnet Config:
    GLOBAL CONFIG
      Inspection Type: stateful
      Check for Encrypted Traffic: YES alert: NO
      Continue to check encrypted data: YES
    TELNET CONFIG:
      Ports: 23 
      Are You There Threshold: 20
      Normalize: YES
      Detect Anomalies: YES
    FTP CONFIG:
      FTP Server: default
        Ports (PAF): 21 2100 3535 
        Check for Telnet Cmds: YES alert: YES
        Ignore Telnet Cmd Operations: YES alert: YES
        Ignore open data channels: NO
      FTP Client: default
        Check for Bounce Attacks: YES alert: YES
        Check for Telnet Cmds: YES alert: YES
        Ignore Telnet Cmd Operations: YES alert: YES
        Max Response Length: 256
SMTP Config:
    Ports: 25 465 587 691 
    Inspection Type: Stateful
    Normalize: ATRN AUTH BDAT DATA DEBUG EHLO EMAL ESAM ESND ESOM ETRN EVFY EXPN HELO HELP IDENT MAIL NOOP ONEX QUEU QUIT RCPT RSET SAML SEND STARTTLS SOML TICK TIME TURN TURNME VERB VRFY X-EXPS XADR XAUTH XCIR XEXCH50 XGEN XLICENSE X-LINK2STATE XQUE XSTA XTRN XUSR CHUNKING X-ADAT X-DRCP X-ERCP X-EXCH50 
    Ignore Data: No
    Ignore TLS Data: No
    Ignore SMTP Alerts: No
    Max Command Line Length: 512
    Max auth Command Line Length: 1000
    Max Specific Command Line Length: 
       ATRN:255 AUTH:246 BDAT:255 DATA:246 DEBUG:255 
       EHLO:500 EMAL:255 ESAM:255 ESND:255 ESOM:255 
       ETRN:246 EVFY:255 EXPN:255 HELO:500 HELP:500 
       IDENT:255 MAIL:260 NOOP:255 ONEX:246 QUEU:246 
       QUIT:246 RCPT:300 RSET:246 SAML:246 SEND:246 
       SIZE:255 STARTTLS:246 SOML:246 TICK:246 TIME:246 
       TURN:246 TURNME:246 VERB:246 VRFY:255 X-EXPS:246 
       XADR:246 XAUTH:246 XCIR:246 XEXCH50:246 XGEN:246 
       XLICENSE:246 X-LINK2STATE:246 XQUE:246 XSTA:246 XTRN:246 
       XUSR:246 
    Max Header Line Length: 1000
    Max Response Line Length: 512
    X-Link2State Alert: Yes
    Drop on X-Link2State Alert: No
    Alert on commands: None
    Alert on unknown commands: No
    SMTP Memcap: 838860
    MIME Max Mem: 838860
    Base64 Decoding: Enabled
    Base64 Decoding Depth: Unlimited
    Quoted-Printable Decoding: Enabled
    Quoted-Printable Decoding Depth: Unlimited
    Unix-to-Unix Decoding: Enabled
    Unix-to-Unix Decoding Depth: Unlimited
    Non-Encoded MIME attachment Extraction: Enabled
    Non-Encoded MIME attachment Extraction Depth: Unlimited
    Log Attachment filename: Enabled
    Log MAIL FROM Address: Enabled
    Log RCPT TO Addresses: Enabled
    Log Email Headers: Enabled
    Email Hdrs Log Depth: 1464
SSH config: 
    Autodetection: ENABLED
    Challenge-Response Overflow Alert: ENABLED
    SSH1 CRC32 Alert: ENABLED
    Server Version String Overflow Alert: ENABLED
    Protocol Mismatch Alert: ENABLED
    Bad Message Direction Alert: DISABLED
    Bad Payload Size Alert: DISABLED
    Unrecognized Version Alert: DISABLED
    Max Encrypted Packets: 20  
    Max Server Version String Length: 100  
    MaxClientBytes: 19600 (Default) 
    Ports:
        22
DCE/RPC 2 Preprocessor Configuration
  Global Configuration
    DCE/RPC Defragmentation: Enabled
    Memcap: 102400 KB
    Events: co 
    SMB Fingerprint policy: Disabled
  Server Default Configuration
    Policy: WinXP
    Detect ports (PAF)
      SMB: 139 445 
      TCP: 135 
      UDP: 135 
      RPC over HTTP server: 593 
      RPC over HTTP proxy: None
    Autodetect ports (PAF)
      SMB: None
      TCP: 1025-65535 
      UDP: 1025-65535 
      RPC over HTTP server: 1025-65535 
      RPC over HTTP proxy: None
    Invalid SMB shares: C$ D$ ADMIN$ 
    Maximum SMB command chaining: 3 commands
    SMB file inspection: Disabled
DNS config: 
    DNS Client rdata txt Overflow Alert: ACTIVE
    Obsolete DNS RR Types Alert: INACTIVE
    Experimental DNS RR Types Alert: INACTIVE
    Ports: 53
SSLPP config:
    Encrypted packets: not inspected
    Ports:
      443      465      563      636      989
      992      993      994      995     7801
     7802     7900     7901     7902     7903
     7904     7905     7906     7907     7908
     7909     7910     7911     7912     7913
     7914     7915     7916     7917     7918
     7919     7920
    Server side data is trusted
    Maximum SSL Heartbeat length: 0
Sensitive Data preprocessor config: 
    Global Alert Threshold: 25
    Masked Output: DISABLED
SIP config: 
    Max number of sessions: 40000  
    Max number of dialogs in a session: 4 (Default) 
    Status: ENABLED
    Ignore media channel: DISABLED
    Max URI length: 512  
    Max Call ID length: 80  
    Max Request name length: 20 (Default) 
    Max From length: 256 (Default) 
    Max To length: 256 (Default) 
    Max Via length: 1024 (Default) 
    Max Contact length: 512  
    Max Content length: 2048  
    Ports:
        5060    5061    5600
    Methods:
          invite cancel ack bye register options refer subscribe update join info message notify benotify do qauth sprack publish service unsubscribe prack
IMAP Config:
    Ports: 143 
    IMAP Memcap: 838860
    MIME Max Mem: 838860
    Base64 Decoding: Enabled
    Base64 Decoding Depth: Unlimited
    Quoted-Printable Decoding: Enabled
    Quoted-Printable Decoding Depth: Unlimited
    Unix-to-Unix Decoding: Enabled
    Unix-to-Unix Decoding Depth: Unlimited
    Non-Encoded MIME attachment Extraction: Enabled
    Non-Encoded MIME attachment Extraction Depth: Unlimited
POP Config:
    Ports: 110 
    POP Memcap: 838860
    MIME Max Mem: 838860
    Base64 Decoding: Enabled
    Base64 Decoding Depth: Unlimited
    Quoted-Printable Decoding: Enabled
    Quoted-Printable Decoding Depth: Unlimited
    Unix-to-Unix Decoding: Enabled
    Unix-to-Unix Decoding Depth: Unlimited
    Non-Encoded MIME attachment Extraction: Enabled
    Non-Encoded MIME attachment Extraction Depth: Unlimited
Modbus config: 
    Ports:
        502
DNP3 config: 
    Memcap: 262144
    Check Link-Layer CRCs: ENABLED
    Ports:
        20000
Reputation config: 
ERROR: /etc/snort/snort.conf(512) => Unable to open address file /etc/snort/../rules/white_list.rules, Error: No such file or directory
Fatal Error, Quitting..
```


### Snort taisyklės analizė


